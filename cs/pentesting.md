# Section 1 - Essential Terminology

## 1.1 Treat

**A threat is a malicious actor whose objective is to breach, cause damage, steal or exfiltrate data from a network or system. Threats usually target assets.**

### 1.1.1 Assets 

**Assets are typically business or service critical systems on a company network that store data, provide services to clients or are integral to the running of the company. As a result, assets are attractive to attackers.
	* Assets can also be employees.
	* During risk assessments/vulnerability assessments, assets need to be identified and adequately secured and protected.
**

### 1.1.2 Risk

**Is the potential impact that a threat or vulnerability will/can have to an organization. Risk is used to determine the probability of a potential vulnerability occurring ad its consequent affect.

## 1.2 Vulnerability 

**A vulnerability is a weakness or flaw in a system or network that, when exploited, will compromise the integrity and security of the system or network and can lead to unauthorized access.**

### 1.2.1 Exploit

**An exploit is the process of breaking in to a system or network through a set of or a particular vulnerabilty. It utilizes a payload to perform specific malicious tasks.**

### 1.2.2 Payload

**A payload is a chunk of exploit code whose purpose is to perform specific tasks on the target system or network, for examples; destroy and exfiltrate data, setup backdoor access, etc.**

### 1.2.3 0-Day

**A Zero-Day is a vulnerability in a system or network that has not yet been patched by the develper.**


# Section 2 - Introduction To Penetration Testing and Penetration Testing Metodologies

## 2.1 The CIA Triad

*The CIA Triad is an integral part of infosec, it involves the use of 5 essential features to ensure that data is kept secure.*

### 2.1.1 Confidentiality

**This ensures that data is accessible to only those that have authorized access. Example; encryption of data to prevent unauthorized access.**

### 2.1.2 Integrity

**This ensures that the integrity of data is maintained and that no unauthorized changes have been made to the data. Example; MD5 signature hashing or checksum.**

### 2.1.3 Availabilty

**This ensures that systems that store and process data are accessible to authorized users when needed. Example; DDoS protection.**

### 2.1.4 Authenticity

**This is used to ensure the authenticity of communication or transfer of data as being genuine, Example; 2FA(2 Factor Authentication), Biometrics, SSL/TLS, etc.**

### 2.1.5 Non-Repudiation

**This is used to ensure that communication between sender and reciever cannot be refuted. For example; IDS.**

## 2.2 Penetration Testing Terminology

### 2.2.1 Breif of Penetration Tesing

* **Penetration tesing is the process of simulation an attack on a network or system to evaluate the security posture of the system and identify vulnerability that can be exploited. This is achieved by simulating various types of attacks on the target network or host.**

* **The main objective of a pentest is to identify vulnerabilities and document how they can be exploited (POC).**

* **Penetration testing requries written permission and authorization from the management/top down authorization model.**

* **The agreement between an organization and a penetration tester should include the following:
	* Scope - What to test
	* Timeframe - When to test, and how long the test will take.**

### 2.2.2 Importances of Penetration Testing

* **Testing security controls & policies**
* **Identifying threats & vulnerabilities**
* **Compliance and regulation testing & maintenance**
* **Testing security infrastructure; firewalls, WAF(Web Application Firewall)**
* **Testing new hardware,software or organizational infrastructure**

### 2.2.3 Blue Team & Read Team

**1. Blue Team
* Is a defence team responsible for performing vulnerability assessments and security audits on the company assets and digital infrastructure to identify vulnerabilities and test the effectiveness of security controls.
* This team's primary objective is to defend against attacks and to predict and prevent future ones.**

**2. Red Team
* Is an offensive team that simulates attacks on the assets and digital infrastucture of an organization to test the overall security posture and to identify weaknesses and vulnerabilities that can be exploited.**

### 2.2.4 Types of Penetration Tests

**1. Black-box testing
* Is testing that involves zero knowledge or information about the organizations digital infrastructure and or assets.
* This test is used to access the overall secruity posture of an organization, from publicly available information to misconfigurations and socical enigneering.
* Black-box testing simulates a real attack scenario and as a result is extremely comprehensive and granular.**

**2. White-box testing
* In this test the complete digital infrastructure and assets are disclosed to the penetration tester and is primarily used by organizations to test specific sections/areas or to perform a complete security audit.**

**3. Grey-box testing
* Involves combining both white and black box testing to simulate attacks from both insiders and outsiders(external threats). Note: Some knowledge of the digital infrasturecture is disclosed, not all.**

### 2.2.5 Penetration Testing Phases

***Penetration Testing Phases
* Pre-Engagement Interactions
->
* Reconnaissance of OSINT
->
* Threat Modeling & Vulnerability Identifications
->
* Exploitations
-> 
* Post-Exploitation Analysis & Recommemdations
->
* Reporting***


## 2.3 Penetration Testing Methodologies

*A penetration testing methodology is a comprehensive methodical approach (or a system) that is used in penetration testing to identify vulnerabilities and weaknesses in the overall security posture of an organization.*

**Advantages:
1 - Clear methodical and systematic approach to testing.
2 - Ensures that tests are reliable, accurate and consistent across the board.**

*Note: Pentesting methodologies need to be exremely comprehensive and accurate to ensure that a penetration test is performed successfully. (A penetration test is only as comprehensive as the methodology that was used).*

### 2.3.1 Open Source penetration Testing Methodologies

***1. OSSTMM - Open Source Security Testing Methodology Manual***
***2. OWASP Testing Methodology - Open Web Application Security Project***


# Section 3 - Setting Up Pentesting Lab

**Requirements
* VirtualBox or VMware
* Kali Linux or any penetration testing distribution of choice**

**Penetration testing distributions
* Kali Linux
* Parrot OS
* BlackArch
* BackBox**

**Penetration testing frameworks
* Katoolin
* PTF - Pentesters Framework**

**Windows tools and frameworks
* WSL
* Pentestbox**

# Section 4 - Passive Information Gathering (OSINT & Publicly Available Information)

## 4.1 Information Gathering Overview

### 4.1.1 What is Information Gathering/Reconnaissance

*Information gathering/footprinting is the first stage in a penetration test and is the process of gathering as much information about the target and it's information systems. This information is then used to find various ways to gain access to the organization's network or infrastructure.*

**Two types of information gathering:
1 - Passive
	Process of gathering information about target without making any direct contact with the target's digital infrastucture. Passive information gathering relies on OSINT(Open-Source INTegllience) or publicly available information.
2 - Active
	Process of gathering information about a target through direct interaction. This process involves directly interacting with the target's IT infrastructure.**

### 4.1.2 Objectives of Information Gathering

* *The main objective of information gathering is to buil da blueprint of the target's organizational structure, network information and host information. This information will be useful in orchestrating the next steps of the penetration test.*

* *It also helps the penetration tester understand the overall security posture of the target network or infrastructure, where flaws or vulnerabilities exists so that he/she can focus on low hanging fruit.*

**Types of information we will be gathering:
1 - Network & host based information - Network ranges and IP blocks, DNS names, TLD's (Top Level Domains), name servers, mail servers and software.
2 - Employee information - Name, email, phone no., identity information, role and interests.**

## 4.2 Passive Information Gathering Techniques & Tools

***Techniques
* Search Engine Recon
	* Google Hacking
	* Shodan
* Social Network Recon
* Whois
* Website Footprinting 
	* HTTrack
	* archive.org
* Web Techonologies Footprinting
	* whatweb
	* builtwith
* Domain & Subdomain Recon
	* Sublist3r
* Cloud Recon
* Metadata***

***OSINT Tools & Frameworks
* Recon-ng
* Maltego
* Sublist3r
* theHarvester
* OSRFramework
* Netcrak
* Shodan
* Metagoofil
* FOCA***

## 4.3 Whois Lookup

*WHOIS (pronounced as the phrase "who is") is a query and response protocol that is widely used for querying databases that store the registered users or assignees of an Internet resource, such as a domain name, an IP address block or an autonomous system, but is also used for a wider range of other information. The protocol stores and delivers database content in a human-readable format.[1] The current iteration of the WHOIS protocol was drafted by the Internet Society, and is documented in RFC 3912.*

*Whois is also the name of the command-line utility on most UNIX systems used to make WHOIS protocol queries.[2] In addition WHOIS has a sister protocol called Referral Whois (RWhois).*


```sh
whois ${DOMAIN_NAME}
```

```sh
whois saicmotor.com.cn
`=>
Domain Name: saicmotor.com.cn
ROID: 20050309s10011s07098734-cn
Domain Status: ok
Registrant: 上海汽车集团股份有限公司
Registrant Contact Email: chengzhibing@saicmotor.com
Sponsoring Registrar: 北京新网数码信息技术有限公司
Name Server: ns11.xincache.com
Name Server: ns12.xincache.com
Registration Time: 2005-03-09 14:43:30
Expiration Time: 2022-03-09 14:43:30
DNSSEC: unsigned
```

```sh
whois roewe.com.cn
`=>
Domain Name: roewe.com.cn
ROID: 20060926s10011s78125073-cn
Domain Status: ok
Registrant: 上海汽车集团股份有限公司乘用车分公司
Registrant Contact Email: yulili@saicmotor.com
Sponsoring Registrar: 阿里云计算有限公司（万网）
Name Server: dns11.hichina.com
Name Server: dns12.hichina.com
Registration Time: 2006-09-26 11:29:04
Expiration Time: 2024-09-26 11:29:04
DNSSEC: unsigned
```

```sh
whois saicmg.com
`=>
   Domain Name: SAICMG.COM
   Registry Domain ID: 1547737526_DOMAIN_COM-VRSN
   Registrar WHOIS Server: grs-whois.hichina.com
   Registrar URL: http://www.net.cn
   Updated Date: 2020-03-03T04:53:53Z
   Creation Date: 2009-03-18T07:49:48Z
   Registry Expiry Date: 2024-03-18T07:49:48Z
   Registrar: Alibaba Cloud Computing (Beijing) Co., Ltd.
   Registrar IANA ID: 420
   Registrar Abuse Contact Email: DomainAbuse@service.aliyun.com
   Registrar Abuse Contact Phone: +86.95187
   Domain Status: ok https://icann.org/epp#ok
   Name Server: DNS29.HICHINA.COM
   Name Server: DNS30.HICHINA.COM
   DNSSEC: unsigned
   URL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/
```

```sh
whois ebanma.com
`=>
   Domain Name: EBANMA.COM
   Registry Domain ID: 1881803106_DOMAIN_COM-VRSN
   Registrar WHOIS Server: grs-whois.hichina.com
   Registrar URL: http://www.net.cn
   Updated Date: 2020-09-14T07:42:04Z
   Creation Date: 2014-10-23T15:13:24Z
   Registry Expiry Date: 2022-10-23T15:13:24Z
   Registrar: Alibaba Cloud Computing (Beijing) Co., Ltd.
   Registrar IANA ID: 420
   Registrar Abuse Contact Email: DomainAbuse@service.aliyun.com
   Registrar Abuse Contact Phone: +86.95187
   Domain Status: ok https://icann.org/epp#ok
   Name Server: VIP1.ALIDNS.COM
   Name Server: VIP2.ALIDNS.COM
   DNSSEC: unsigned
   URL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/
```

## 4.4 Email Harvesting With theHarvester

```sh
theHarvester -d roewe.com.cn -l 500 -b baidu                    
`=>                                              
[*] Target: roewe.com.cn 
                                                                                             
[*] Searching Baidu. 

[*] No IPs found.

[*] No emails found.

[*] Hosts found: 7
---------------------
activity.roewe.com.cn:47.103.125.225
cms-qa.roewe.com.cn:139.224.175.87, 117.184.122.85
rw.cep.roewe.com.cn:139.196.71.30
rw.roewe.com.cn:139.196.71.30
social.roewe.com.cn:139.227.230.98
vmall.roewe.com.cn:139.224.175.87
www.roewe.com.cn:140.207.195.68, 140.207.195.73, 140.207.195.71, 140.207.195.67, 140.207.195.74, 140.207.195.70, 140.207.195.69, 140.207.195.72
```

## 4.5 OSINT With Maltego

https://www.maltego.com/

*Registered email address: luo.jun6@gmail.com*

## 4.6 Passive Recon With OSRFramework

https://github.com/i3visio/osrframework

*OSRFramework, the Open Sources Research Framework is a AGPLv3+ project by i3visio focused on providing API and tools to perform more accurate online researches.*

```sh
osrf
`=>
usage: osrf [-h] [--license] [--version]
            <sub_command> <sub_command_options> ...

OSRFramework CLI. Collection of tools included in the framework.

SUBCOMMANDS:
  List of available commands that can be invoked using OSRFramework CLI.

  <sub_command> <sub_command_options>
    alias_generator     Generates a list of candidate usernames based on
                        known information.
    checkfy             Verifies if a given email address matches a
                        pattern.
    domainfy            Checks whether domain names using words and
                        nicknames are available.
    mailfy              Gets information about email accounts.
    phonefy             Looks for information linked to spam practices by
                        a phone number.
    searchfy            Performs queries on several platforms.
    usufy               Looks for registered accounts with given
                        nicknames.
    upgrade             Updates the module.
```

# Section 5 - Active Information Gathering 

# Section 6 - Enumeration

## 6.1 Managing DNS With resolvconf

```sh
cat /etc/resolv.conf 
`=>
# This file is managed by man:systemd-resolved(8). Do not edit.
#
# This is a dynamic resolv.conf file for connecting local clients to the
# internal DNS stub resolver of systemd-resolved. This file lists all
# configured search domains.
#
# Run "resolvectl status" to see details about the uplink DNS servers
# currently in use.
#
# Third party programs must not access this file directly, but only through the
# symlink at /etc/resolv.conf. To manage man:resolv.conf(5) in a different way,
# replace this symlink by a static file or a different symlink.
#
# See man:systemd-resolved.service(8) for details about the supported modes of
# operation for /etc/resolv.conf.

nameserver 127.0.0.53
options edns0 trust-ad
```

```sh
sudo apt install resolvconf
```

```sh
systemctl enable resolvconf
`=>
Synchronizing state of resolvconf.service with SysV service script with /lib/systemd/systemd-sysv-install.
Executing: /lib/systemd/systemd-sysv-install enable resolvconf
```


```sh
systemctl status resolvconf
`=>
● resolvconf.service - Nameserver information manager
     Loaded: loaded (/lib/systemd/system/resolvconf.service; enabled; vend>
     Active: active (exited) since Thu 2021-09-23 16:10:31 CST; 1min 33s a>
       Docs: man:resolvconf(8)
   Main PID: 397507 (code=exited, status=0/SUCCESS)
      Tasks: 0 (limit: 9262)
     Memory: 0B
     CGroup: /system.slice/resolvconf.service

9月 23 16:10:31 lawjune-ThinkPad-T530 systemd[1]: Started Nameserver infor>
9月 23 16:10:31 lawjune-ThinkPad-T530 resolvconf[397512]: /etc/resolvconf/>
```

*To add nameserver in `/etc/resolvconf/resolv.conf.d/base`*

*You can see the new added nameservers in `/etc/resolv.conf` after restarting resolvconf.service. For example:
nameserver 192.168.1.1
nameserver 1.1.1.1
nameserver 8.8.8.8
*

*To add dns-servername in `vim /etc/network/interfaces` for example:
dns-nameservers: 1.1.1.1 8.8.8.8 8.8.4.4
*

*Then restart NetworkManger and resolvconf.service*

## 6.2 Subdomain Enumeration With Sublist3r

https://github.com/aboul3la/Sublist3r

```sh
sudo ln -sf /home/lawjune/Documents/EthicalHacking/Sublist3r/sublist3r.py /usr/bin/sublist3r
```

```sh
sublist3r -h
`=>
usage: sublist3r [-h] -d DOMAIN [-b [BRUTEFORCE]] [-p PORTS]
                 [-v [VERBOSE]] [-t THREADS] [-e ENGINES] [-o OUTPUT]
                 [-n]

OPTIONS:
  -h, --help            show this help message and exit
  -d DOMAIN, --domain DOMAIN
                        Domain name to enumerate it's subdomains
  -b [BRUTEFORCE], --bruteforce [BRUTEFORCE]
                        Enable the subbrute bruteforce module
  -p PORTS, --ports PORTS
                        Scan the found subdomains against specified tcp
                        ports
  -v [VERBOSE], --verbose [VERBOSE]
                        Enable Verbosity and display results in realtime
  -t THREADS, --threads THREADS
                        Number of threads to use for subbrute bruteforce
  -e ENGINES, --engines ENGINES
                        Specify a comma-separated list of search engines
  -o OUTPUT, --output OUTPUT
                        Save the results to text file
  -n, --no-color        Output without color

Example: python /usr/bin/sublist3r -d google.com
```

## 6.3 DNS Enumeration and Zone Transfer

https://digi.ninja/projects/zonetransferme.php

### 6.3.1 host

```sh
whatis host
`=>
host (1)             - DNS lookup utility
```

```sh
host zonetransfer.me
`=>
zonetransfer.me has address 5.196.105.14
zonetransfer.me mail is handled by 20 ASPMX5.GOOGLEMAIL.COM.
zonetransfer.me mail is handled by 10 ALT2.ASPMX.L.GOOGLE.COM.
zonetransfer.me mail is handled by 10 ALT1.ASPMX.L.GOOGLE.COM.
zonetransfer.me mail is handled by 0 ASPMX.L.GOOGLE.COM.
zonetransfer.me mail is handled by 20 ASPMX3.GOOGLEMAIL.COM.
zonetransfer.me mail is handled by 20 ASPMX2.GOOGLEMAIL.COM.
zonetransfer.me mail is handled by 20 ASPMX4.GOOGLEMAIL.COM.
```

```sh
host -t ns zonetransfer.me
`=>
zonetransfer.me name server nsztm1.digi.ninja.
zonetransfer.me name server nsztm2.digi.ninja.
```

```sh
host -t a zonetransfer.me
`=>
zonetransfer.me has address 5.196.105.14
```

```sh
host -t mx zonetransfer.me
`=>
zonetransfer.me mail is handled by 20 ASPMX5.GOOGLEMAIL.COM.
zonetransfer.me mail is handled by 10 ALT2.ASPMX.L.GOOGLE.COM.
zonetransfer.me mail is handled by 10 ALT1.ASPMX.L.GOOGLE.COM.
zonetransfer.me mail is handled by 0 ASPMX.L.GOOGLE.COM.
zonetransfer.me mail is handled by 20 ASPMX3.GOOGLEMAIL.COM.
zonetransfer.me mail is handled by 20 ASPMX2.GOOGLEMAIL.COM.
zonetransfer.me mail is handled by 20 ASPMX4.GOOGLEMAIL.COM.
```

## 6.3.2 dig

```sh
whatis dig
`=>
dig (1)              - DNS lookup utility
```

```sh
dig zonetransfer.me
`=>
; <<>> DiG 9.16.1-Ubuntu <<>> zonetransfer.me
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 40669
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 65494
;; QUESTION SECTION:
;zonetransfer.me.		IN	A

;; ANSWER SECTION:
zonetransfer.me.	4028	IN	A	5.196.105.14

;; Query time: 0 msec
;; SERVER: 127.0.0.53#53(127.0.0.53)
;; WHEN: 五 9月 24 08:22:01 CST 2021
;; MSG SIZE  rcvd: 60
```

```sh
dig -t ns zonetransfer.me
`=>
; <<>> DiG 9.16.1-Ubuntu <<>> -t ns zonetransfer.me
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 5033
;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 65494
;; QUESTION SECTION:
;zonetransfer.me.		IN	NS

;; ANSWER SECTION:
zonetransfer.me.	4229	IN	NS	nsztm1.digi.ninja.
zonetransfer.me.	4229	IN	NS	nsztm2.digi.ninja.

;; Query time: 0 msec
;; SERVER: 127.0.0.53#53(127.0.0.53)
;; WHEN: 五 9月 24 08:22:55 CST 2021
;; MSG SIZE  rcvd: 96
```

```sh
dig axfr zonetransfer.me @nsztm1.digi.ninja
`=>
; <<>> DiG 9.16.1-Ubuntu <<>> axfr zonetransfer.me @nsztm1.digi.ninja
;; global options: +cmd
zonetransfer.me.	7200	IN	SOA	nsztm1.digi.ninja. robin.digi.ninja. 2019100801 172800 900 1209600 3600
zonetransfer.me.	300	IN	HINFO	"Casio fx-700G" "Windows XP"
zonetransfer.me.	301	IN	TXT	"google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA"
zonetransfer.me.	7200	IN	MX	0 ASPMX.L.GOOGLE.COM.
zonetransfer.me.	7200	IN	MX	10 ALT1.ASPMX.L.GOOGLE.COM.
zonetransfer.me.	7200	IN	MX	10 ALT2.ASPMX.L.GOOGLE.COM.
zonetransfer.me.	7200	IN	MX	20 ASPMX2.GOOGLEMAIL.COM.
zonetransfer.me.	7200	IN	MX	20 ASPMX3.GOOGLEMAIL.COM.
zonetransfer.me.	7200	IN	MX	20 ASPMX4.GOOGLEMAIL.COM.
zonetransfer.me.	7200	IN	MX	20 ASPMX5.GOOGLEMAIL.COM.
zonetransfer.me.	7200	IN	A	5.196.105.14
zonetransfer.me.	7200	IN	NS	nsztm1.digi.ninja.
zonetransfer.me.	7200	IN	NS	nsztm2.digi.ninja.
_acme-challenge.zonetransfer.me. 301 IN	TXT	"6Oa05hbUJ9xSsvYy7pApQvwCUSSGgxvrbdizjePEsZI"
_sip._tcp.zonetransfer.me. 14000 IN	SRV	0 0 5060 www.zonetransfer.me.
14.105.196.5.IN-ADDR.ARPA.zonetransfer.me. 7200	IN PTR www.zonetransfer.me.
asfdbauthdns.zonetransfer.me. 7900 IN	AFSDB	1 asfdbbox.zonetransfer.me.
asfdbbox.zonetransfer.me. 7200	IN	A	127.0.0.1
asfdbvolume.zonetransfer.me. 7800 IN	AFSDB	1 asfdbbox.zonetransfer.me.
canberra-office.zonetransfer.me. 7200 IN A	202.14.81.230
cmdexec.zonetransfer.me. 300	IN	TXT	"; ls"
contact.zonetransfer.me. 2592000 IN	TXT	"Remember to call or email Pippa on +44 123 4567890 or pippa@zonetransfer.me when making DNS changes"
dc-office.zonetransfer.me. 7200	IN	A	143.228.181.132
deadbeef.zonetransfer.me. 7201	IN	AAAA	dead:beaf::
dr.zonetransfer.me.	300	IN	LOC	53 20 56.558 N 1 38 33.526 W 0.00m 1m 10000m 10m
DZC.zonetransfer.me.	7200	IN	TXT	"AbCdEfG"
email.zonetransfer.me.	2222	IN	NAPTR	1 1 "P" "E2U+email" "" email.zonetransfer.me.zonetransfer.me.
email.zonetransfer.me.	7200	IN	A	74.125.206.26
Hello.zonetransfer.me.	7200	IN	TXT	"Hi to Josh and all his class"
home.zonetransfer.me.	7200	IN	A	127.0.0.1
Info.zonetransfer.me.	7200	IN	TXT	"ZoneTransfer.me service provided by Robin Wood - robin@digi.ninja. See http://digi.ninja/projects/zonetransferme.php for more information."
internal.zonetransfer.me. 300	IN	NS	intns1.zonetransfer.me.
internal.zonetransfer.me. 300	IN	NS	intns2.zonetransfer.me.
intns1.zonetransfer.me.	300	IN	A	81.4.108.41
intns2.zonetransfer.me.	300	IN	A	167.88.42.94
office.zonetransfer.me.	7200	IN	A	4.23.39.254
ipv6actnow.org.zonetransfer.me.	7200 IN	AAAA	2001:67c:2e8:11::c100:1332
owa.zonetransfer.me.	7200	IN	A	207.46.197.32
robinwood.zonetransfer.me. 302	IN	TXT	"Robin Wood"
rp.zonetransfer.me.	321	IN	RP	robin.zonetransfer.me. robinwood.zonetransfer.me.
sip.zonetransfer.me.	3333	IN	NAPTR	2 3 "P" "E2U+sip" "!^.*$!sip:customer-service@zonetransfer.me!" .
sqli.zonetransfer.me.	300	IN	TXT	"' or 1=1 --"
sshock.zonetransfer.me.	7200	IN	TXT	"() { :]}; echo ShellShocked"
staging.zonetransfer.me. 7200	IN	CNAME	www.sydneyoperahouse.com.
alltcpportsopen.firewall.test.zonetransfer.me. 301 IN A	127.0.0.1
testing.zonetransfer.me. 301	IN	CNAME	www.zonetransfer.me.
vpn.zonetransfer.me.	4000	IN	A	174.36.59.154
www.zonetransfer.me.	7200	IN	A	5.196.105.14
xss.zonetransfer.me.	300	IN	TXT	"'><script>alert('Boo')</script>"
zonetransfer.me.	7200	IN	SOA	nsztm1.digi.ninja. robin.digi.ninja. 2019100801 172800 900 1209600 3600
;; Query time: 271 msec
;; SERVER: 81.4.108.41#53(81.4.108.41)
;; WHEN: 五 9月 24 08:25:09 CST 2021
;; XFR size: 50 records (messages 1, bytes 1994)
```

```sh
dig axfr zonetransfer.me @nsztm2.digi.ninja
`=>
; <<>> DiG 9.16.1-Ubuntu <<>> axfr zonetransfer.me @nsztm2.digi.ninja
;; global options: +cmd
zonetransfer.me.	7200	IN	SOA	nsztm1.digi.ninja. robin.digi.ninja. 2019100801 172800 900 1209600 3600
zonetransfer.me.	300	IN	HINFO	"Casio fx-700G" "Windows XP"
zonetransfer.me.	301	IN	TXT	"google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA"
zonetransfer.me.	7200	IN	MX	0 ASPMX.L.GOOGLE.COM.
zonetransfer.me.	7200	IN	MX	10 ALT1.ASPMX.L.GOOGLE.COM.
zonetransfer.me.	7200	IN	MX	10 ALT2.ASPMX.L.GOOGLE.COM.
zonetransfer.me.	7200	IN	MX	20 ASPMX2.GOOGLEMAIL.COM.
zonetransfer.me.	7200	IN	MX	20 ASPMX3.GOOGLEMAIL.COM.
zonetransfer.me.	7200	IN	MX	20 ASPMX4.GOOGLEMAIL.COM.
zonetransfer.me.	7200	IN	MX	20 ASPMX5.GOOGLEMAIL.COM.
zonetransfer.me.	7200	IN	A	5.196.105.14
zonetransfer.me.	7200	IN	NS	nsztm1.digi.ninja.
zonetransfer.me.	7200	IN	NS	nsztm2.digi.ninja.
_acme-challenge.zonetransfer.me. 301 IN	TXT	"2acOp15rSxBpyF6L7TqnAoW8aI0vqMU5kpXQW7q4egc"
_acme-challenge.zonetransfer.me. 301 IN	TXT	"6Oa05hbUJ9xSsvYy7pApQvwCUSSGgxvrbdizjePEsZI"
_sip._tcp.zonetransfer.me. 14000 IN	SRV	0 0 5060 www.zonetransfer.me.
14.105.196.5.IN-ADDR.ARPA.zonetransfer.me. 7200	IN PTR www.zonetransfer.me.
asfdbauthdns.zonetransfer.me. 7900 IN	AFSDB	1 asfdbbox.zonetransfer.me.
asfdbbox.zonetransfer.me. 7200	IN	A	127.0.0.1
asfdbvolume.zonetransfer.me. 7800 IN	AFSDB	1 asfdbbox.zonetransfer.me.
canberra-office.zonetransfer.me. 7200 IN A	202.14.81.230
cmdexec.zonetransfer.me. 300	IN	TXT	"; ls"
contact.zonetransfer.me. 2592000 IN	TXT	"Remember to call or email Pippa on +44 123 4567890 or pippa@zonetransfer.me when making DNS changes"
dc-office.zonetransfer.me. 7200	IN	A	143.228.181.132
deadbeef.zonetransfer.me. 7201	IN	AAAA	dead:beaf::
dr.zonetransfer.me.	300	IN	LOC	53 20 56.558 N 1 38 33.526 W 0.00m 1m 10000m 10m
DZC.zonetransfer.me.	7200	IN	TXT	"AbCdEfG"
email.zonetransfer.me.	2222	IN	NAPTR	1 1 "P" "E2U+email" "" email.zonetransfer.me.zonetransfer.me.
email.zonetransfer.me.	7200	IN	A	74.125.206.26
Hello.zonetransfer.me.	7200	IN	TXT	"Hi to Josh and all his class"
home.zonetransfer.me.	7200	IN	A	127.0.0.1
Info.zonetransfer.me.	7200	IN	TXT	"ZoneTransfer.me service provided by Robin Wood - robin@digi.ninja. See http://digi.ninja/projects/zonetransferme.php for more information."
internal.zonetransfer.me. 300	IN	NS	intns1.zonetransfer.me.
internal.zonetransfer.me. 300	IN	NS	intns2.zonetransfer.me.
intns1.zonetransfer.me.	300	IN	A	81.4.108.41
intns2.zonetransfer.me.	300	IN	A	52.91.28.78
office.zonetransfer.me.	7200	IN	A	4.23.39.254
ipv6actnow.org.zonetransfer.me.	7200 IN	AAAA	2001:67c:2e8:11::c100:1332
owa.zonetransfer.me.	7200	IN	A	207.46.197.32
robinwood.zonetransfer.me. 302	IN	TXT	"Robin Wood"
rp.zonetransfer.me.	321	IN	RP	robin.zonetransfer.me. robinwood.zonetransfer.me.
sip.zonetransfer.me.	3333	IN	NAPTR	2 3 "P" "E2U+sip" "!^.*$!sip:customer-service@zonetransfer.me!" .
sqli.zonetransfer.me.	300	IN	TXT	"' or 1=1 --"
sshock.zonetransfer.me.	7200	IN	TXT	"() { :]}; echo ShellShocked"
staging.zonetransfer.me. 7200	IN	CNAME	www.sydneyoperahouse.com.
alltcpportsopen.firewall.test.zonetransfer.me. 301 IN A	127.0.0.1
testing.zonetransfer.me. 301	IN	CNAME	www.zonetransfer.me.
vpn.zonetransfer.me.	4000	IN	A	174.36.59.154
www.zonetransfer.me.	7200	IN	A	5.196.105.14
xss.zonetransfer.me.	300	IN	TXT	"'><script>alert('Boo')</script>"
zonetransfer.me.	7200	IN	SOA	nsztm1.digi.ninja. robin.digi.ninja. 2019100801 172800 900 1209600 3600
;; Query time: 263 msec
;; SERVER: 34.225.33.2#53(34.225.33.2)
;; WHEN: 五 9月 24 08:28:28 CST 2021
;; XFR size: 51 records (messages 1, bytes 2141)
```

### 6.3.3 dnsenum

```sh
whatis dnsenum
`=>
dnsenum (1)          - - multithread script to enumerate information on a ...
```

```sh
dnsenum zonetransfer.me
`=>
dnsenum VERSION:1.2.6

-----   zonetransfer.me   -----


Host's addresses:
__________________

zonetransfer.me.                         3489     IN    A        5.196.105.14


Name Servers:                                                                
______________                                                               
                                                                             
nsztm2.digi.ninja.                       4349     IN    A        34.225.33.2 
nsztm1.digi.ninja.                       4135     IN    A        81.4.108.41

                                                                             
Mail (MX) Servers:                                                           
___________________                                                          
                                                                             
ASPMX4.GOOGLEMAIL.COM.                   368      IN    A        64.233.171.27
ASPMX2.GOOGLEMAIL.COM.                   77       IN    A        142.250.141.26
ASPMX3.GOOGLEMAIL.COM.                   368      IN    A        142.250.115.27
ASPMX.L.GOOGLE.COM.                      368      IN    A        108.177.97.27
ALT1.ASPMX.L.GOOGLE.COM.                 368      IN    A        142.250.141.27
ALT2.ASPMX.L.GOOGLE.COM.                 368      IN    A        142.250.115.27
ASPMX5.GOOGLEMAIL.COM.                   368      IN    A        142.250.152.27

                                                                             
Trying Zone Transfers and getting Bind Versions:                             
_________________________________________________                            
                                                                             
                                                                             
Trying Zone Transfer for zonetransfer.me on nsztm2.digi.ninja ... 
zonetransfer.me.                         7200     IN    SOA               (
zonetransfer.me.                         300      IN    HINFO        "Casio
zonetransfer.me.                         301      IN    TXT               (
zonetransfer.me.                         7200     IN    MX                0
zonetransfer.me.                         7200     IN    MX               10
zonetransfer.me.                         7200     IN    MX               10
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    A        5.196.105.14
zonetransfer.me.                         7200     IN    NS       nsztm1.digi.ninja.
zonetransfer.me.                         7200     IN    NS       nsztm2.digi.ninja.
_acme-challenge.zonetransfer.me.         301      IN    TXT               (
_acme-challenge.zonetransfer.me.         301      IN    TXT               (
_sip._tcp.zonetransfer.me.               14000    IN    SRV               0
14.105.196.5.IN-ADDR.ARPA.zonetransfer.me. 7200     IN    PTR      www.zonetransfer.me.
asfdbauthdns.zonetransfer.me.            7900     IN    AFSDB             1
asfdbbox.zonetransfer.me.                7200     IN    A         127.0.0.1
asfdbvolume.zonetransfer.me.             7800     IN    AFSDB             1
canberra-office.zonetransfer.me.         7200     IN    A        202.14.81.230
cmdexec.zonetransfer.me.                 300      IN    TXT              ";
contact.zonetransfer.me.                 2592000  IN    TXT               (
dc-office.zonetransfer.me.               7200     IN    A        143.228.181.132
deadbeef.zonetransfer.me.                7201     IN    AAAA     dead:beaf::
dr.zonetransfer.me.                      300      IN    LOC              53
DZC.zonetransfer.me.                     7200     IN    TXT         AbCdEfG
email.zonetransfer.me.                   2222     IN    NAPTR             (
email.zonetransfer.me.                   7200     IN    A        74.125.206.26
Hello.zonetransfer.me.                   7200     IN    TXT             "Hi
home.zonetransfer.me.                    7200     IN    A         127.0.0.1
Info.zonetransfer.me.                    7200     IN    TXT               (
internal.zonetransfer.me.                300      IN    NS       intns1.zonetransfer.me.
internal.zonetransfer.me.                300      IN    NS       intns2.zonetransfer.me.
intns1.zonetransfer.me.                  300      IN    A        81.4.108.41
intns2.zonetransfer.me.                  300      IN    A        52.91.28.78
office.zonetransfer.me.                  7200     IN    A        4.23.39.254
ipv6actnow.org.zonetransfer.me.          7200     IN    AAAA     2001:67c:2e8:11::c100:1332
owa.zonetransfer.me.                     7200     IN    A        207.46.197.32
robinwood.zonetransfer.me.               302      IN    TXT          "Robin
rp.zonetransfer.me.                      321      IN    RP                (
sip.zonetransfer.me.                     3333     IN    NAPTR             (
sqli.zonetransfer.me.                    300      IN    TXT              "'
sshock.zonetransfer.me.                  7200     IN    TXT             "()
staging.zonetransfer.me.                 7200     IN    CNAME    www.sydneyoperahouse.com.
alltcpportsopen.firewall.test.zonetransfer.me. 301      IN    A         127.0.0.1
testing.zonetransfer.me.                 301      IN    CNAME    www.zonetransfer.me.
vpn.zonetransfer.me.                     4000     IN    A        174.36.59.154
www.zonetransfer.me.                     7200     IN    A        5.196.105.14
xss.zonetransfer.me.                     300      IN    TXT      "'><script>alert('Boo')</script>"

Trying Zone Transfer for zonetransfer.me on nsztm1.digi.ninja ... 
zonetransfer.me.                         7200     IN    SOA               (
zonetransfer.me.                         300      IN    HINFO        "Casio
zonetransfer.me.                         301      IN    TXT               (
zonetransfer.me.                         7200     IN    MX                0
zonetransfer.me.                         7200     IN    MX               10
zonetransfer.me.                         7200     IN    MX               10
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    A        5.196.105.14
zonetransfer.me.                         7200     IN    NS       nsztm1.digi.ninja.
zonetransfer.me.                         7200     IN    NS       nsztm2.digi.ninja.
_acme-challenge.zonetransfer.me.         301      IN    TXT               (
_sip._tcp.zonetransfer.me.               14000    IN    SRV               0
14.105.196.5.IN-ADDR.ARPA.zonetransfer.me. 7200     IN    PTR      www.zonetransfer.me.
asfdbauthdns.zonetransfer.me.            7900     IN    AFSDB             1
asfdbbox.zonetransfer.me.                7200     IN    A         127.0.0.1
asfdbvolume.zonetransfer.me.             7800     IN    AFSDB             1
canberra-office.zonetransfer.me.         7200     IN    A        202.14.81.230
cmdexec.zonetransfer.me.                 300      IN    TXT              ";
contact.zonetransfer.me.                 2592000  IN    TXT               (
dc-office.zonetransfer.me.               7200     IN    A        143.228.181.132
deadbeef.zonetransfer.me.                7201     IN    AAAA     dead:beaf::
dr.zonetransfer.me.                      300      IN    LOC              53
DZC.zonetransfer.me.                     7200     IN    TXT         AbCdEfG
email.zonetransfer.me.                   2222     IN    NAPTR             (
email.zonetransfer.me.                   7200     IN    A        74.125.206.26
Hello.zonetransfer.me.                   7200     IN    TXT             "Hi
home.zonetransfer.me.                    7200     IN    A         127.0.0.1
Info.zonetransfer.me.                    7200     IN    TXT               (
internal.zonetransfer.me.                300      IN    NS       intns1.zonetransfer.me.
internal.zonetransfer.me.                300      IN    NS       intns2.zonetransfer.me.
intns1.zonetransfer.me.                  300      IN    A        81.4.108.41
intns2.zonetransfer.me.                  300      IN    A        167.88.42.94
office.zonetransfer.me.                  7200     IN    A        4.23.39.254
ipv6actnow.org.zonetransfer.me.          7200     IN    AAAA     2001:67c:2e8:11::c100:1332
owa.zonetransfer.me.                     7200     IN    A        207.46.197.32
robinwood.zonetransfer.me.               302      IN    TXT          "Robin
rp.zonetransfer.me.                      321      IN    RP                (
sip.zonetransfer.me.                     3333     IN    NAPTR             (
sqli.zonetransfer.me.                    300      IN    TXT              "'
sshock.zonetransfer.me.                  7200     IN    TXT             "()
staging.zonetransfer.me.                 7200     IN    CNAME    www.sydneyoperahouse.com.
alltcpportsopen.firewall.test.zonetransfer.me. 301      IN    A         127.0.0.1
testing.zonetransfer.me.                 301      IN    CNAME    www.zonetransfer.me.
vpn.zonetransfer.me.                     4000     IN    A        174.36.59.154
www.zonetransfer.me.                     7200     IN    A        5.196.105.14
xss.zonetransfer.me.                     300      IN    TXT      "'><script>alert('Boo')</script>"
```

### 6.3.4 fierce

```sh
whatis fierce
`=>
fierce (1)           - DNS scanner that helps locate non-contiguous IP spa...
```

```sh
fierce --domain zonetransfer.me
`=>
NS: nsztm2.digi.ninja. nsztm1.digi.ninja.
SOA: nsztm1.digi.ninja. (81.4.108.41)
Zone: success
{<DNS name @>: '@ 7200 IN SOA nsztm1.digi.ninja. robin.digi.ninja. 2019100801 '
               '172800 900 1209600 3600\n'
               '@ 300 IN HINFO "Casio fx-700G" "Windows XP"\n'
               '@ 301 IN TXT '
               '"google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA"\n'
               '@ 7200 IN MX 0 ASPMX.L.GOOGLE.COM.\n'
               '@ 7200 IN MX 10 ALT1.ASPMX.L.GOOGLE.COM.\n'
               '@ 7200 IN MX 10 ALT2.ASPMX.L.GOOGLE.COM.\n'
               '@ 7200 IN MX 20 ASPMX2.GOOGLEMAIL.COM.\n'
               '@ 7200 IN MX 20 ASPMX3.GOOGLEMAIL.COM.\n'
               '@ 7200 IN MX 20 ASPMX4.GOOGLEMAIL.COM.\n'
               '@ 7200 IN MX 20 ASPMX5.GOOGLEMAIL.COM.\n'
               '@ 7200 IN A 5.196.105.14\n'
               '@ 7200 IN NS nsztm1.digi.ninja.\n'
               '@ 7200 IN NS nsztm2.digi.ninja.',
 <DNS name _acme-challenge>: '_acme-challenge 301 IN TXT '
                             '"6Oa05hbUJ9xSsvYy7pApQvwCUSSGgxvrbdizjePEsZI"',
 <DNS name _sip._tcp>: '_sip._tcp 14000 IN SRV 0 0 5060 www',
 <DNS name 14.105.196.5.IN-ADDR.ARPA>: '14.105.196.5.IN-ADDR.ARPA 7200 IN PTR '
                                       'www',
 <DNS name asfdbauthdns>: 'asfdbauthdns 7900 IN AFSDB 1 asfdbbox',
 <DNS name asfdbbox>: 'asfdbbox 7200 IN A 127.0.0.1',
 <DNS name asfdbvolume>: 'asfdbvolume 7800 IN AFSDB 1 asfdbbox',
 <DNS name canberra-office>: 'canberra-office 7200 IN A 202.14.81.230',
 <DNS name cmdexec>: 'cmdexec 300 IN TXT "; ls"',
 <DNS name contact>: 'contact 2592000 IN TXT "Remember to call or email Pippa '
                     'on +44 123 4567890 or pippa@zonetransfer.me when making '
                     'DNS changes"',
 <DNS name dc-office>: 'dc-office 7200 IN A 143.228.181.132',
 <DNS name deadbeef>: 'deadbeef 7201 IN AAAA dead:beaf::',
 <DNS name dr>: 'dr 300 IN LOC 53 20 56.558 N 1 38 33.526 W 0.00m',
 <DNS name DZC>: 'DZC 7200 IN TXT "AbCdEfG"',
 <DNS name email>: 'email 2222 IN NAPTR 1 1 "P" "E2U+email" "" '
                   'email.zonetransfer.me\n'
                   'email 7200 IN A 74.125.206.26',
 <DNS name Hello>: 'Hello 7200 IN TXT "Hi to Josh and all his class"',
 <DNS name home>: 'home 7200 IN A 127.0.0.1',
 <DNS name Info>: 'Info 7200 IN TXT "ZoneTransfer.me service provided by Robin '
                  'Wood - robin@digi.ninja. See '
                  'http://digi.ninja/projects/zonetransferme.php for more '
                  'information."',
 <DNS name internal>: 'internal 300 IN NS intns1\ninternal 300 IN NS intns2',
 <DNS name intns1>: 'intns1 300 IN A 81.4.108.41',
 <DNS name intns2>: 'intns2 300 IN A 167.88.42.94',
 <DNS name office>: 'office 7200 IN A 4.23.39.254',
 <DNS name ipv6actnow.org>: 'ipv6actnow.org 7200 IN AAAA '
                            '2001:67c:2e8:11::c100:1332',
 <DNS name owa>: 'owa 7200 IN A 207.46.197.32',
 <DNS name robinwood>: 'robinwood 302 IN TXT "Robin Wood"',
 <DNS name rp>: 'rp 321 IN RP robin robinwood',
 <DNS name sip>: 'sip 3333 IN NAPTR 2 3 "P" "E2U+sip" '
                 '"!^.*$!sip:customer-service@zonetransfer.me!" .',
 <DNS name sqli>: 'sqli 300 IN TXT "\' or 1=1 --"',
 <DNS name sshock>: 'sshock 7200 IN TXT "() { :]}; echo ShellShocked"',
 <DNS name staging>: 'staging 7200 IN CNAME www.sydneyoperahouse.com.',
 <DNS name alltcpportsopen.firewall.test>: 'alltcpportsopen.firewall.test 301 '
                                           'IN A 127.0.0.1',
 <DNS name testing>: 'testing 301 IN CNAME www',
 <DNS name vpn>: 'vpn 4000 IN A 174.36.59.154',
 <DNS name www>: 'www 7200 IN A 5.196.105.14',
 <DNS name xss>: 'xss 300 IN TXT "\'><script>alert(\'Boo\')</script>"'}
```

## 6.4 DNS Bruteforcing and Subdomain Enueration with Fierce & Nmap

### 6.4.1 SecLists

https://github.com/danielmiessler/SecLists

### 6.4.2 nmap

```sh
ls -al /usr/share/nmap/scripts | grep dns
`=>
-rw-r--r-- 1 root root  1499 10月 12  2020 broadcast-dns-service-discovery.nse
-rw-r--r-- 1 root root  5329 10月 12  2020 dns-blacklist.nse
-rw-r--r-- 1 root root 10100 10月 12  2020 dns-brute.nse
-rw-r--r-- 1 root root  6639 10月 12  2020 dns-cache-snoop.nse
-rw-r--r-- 1 root root 15152 10月 12  2020 dns-check-zone.nse
-rw-r--r-- 1 root root 14826 10月 12  2020 dns-client-subnet-scan.nse
-rw-r--r-- 1 root root 10168 10月 12  2020 dns-fuzz.nse
-rw-r--r-- 1 root root  3803 10月 12  2020 dns-ip6-arpa-scan.nse
-rw-r--r-- 1 root root 12702 10月 12  2020 dns-nsec3-enum.nse
-rw-r--r-- 1 root root 10580 10月 12  2020 dns-nsec-enum.nse
-rw-r--r-- 1 root root  3441 10月 12  2020 dns-nsid.nse
-rw-r--r-- 1 root root  4364 10月 12  2020 dns-random-srcport.nse
-rw-r--r-- 1 root root  4363 10月 12  2020 dns-random-txid.nse
-rw-r--r-- 1 root root  1456 10月 12  2020 dns-recursion.nse
-rw-r--r-- 1 root root  2195 10月 12  2020 dns-service-discovery.nse
-rw-r--r-- 1 root root  5679 10月 12  2020 dns-srv-enum.nse
-rw-r--r-- 1 root root  5765 10月 12  2020 dns-update.nse
-rw-r--r-- 1 root root  2123 10月 12  2020 dns-zeustracker.nse
-rw-r--r-- 1 root root 26574 10月 12  2020 dns-zone-transfer.nse
-rw-r--r-- 1 root root  3910 10月 12  2020 fcrdns.nse
```

```sh
nmap -p 53 --script dns-brute zonetransfer.me
```

### 6.4.3 dnsmap

```sh
whatis dnsmap
`=>
dnsmap (1)           - scan for subdomains using bruteforcing techniques
```

### 6.4.4 fierce (Recommended)


# Section 7 - Vulnerability Scanning (Nessus, OpenVAS, Nikto, etc)

## 7.1 Network Scanning

### 7.1.1 TCP Flags & TCP 3-Way Handshake

**Scanning
* Scanig is typically conducted after extensive passive reconnaissance has been conducted on the target. The objective is to identify active targets and potential access vectors in the form of ports and services.
* This statge does not involve any exploitation or gaining of access, rather, it is focused on building a profile of the target based on information like OS version, service versions and any misconfigurations in the stack.**

***Objectives:
* 1 - Host discovery
* 2 - OS and service detection
* 3 - UDP scanning
* 4 - Stealth scans
* 5 - Firewall evasion***

**Types of scanning
* Network Scanning
	* Network scanning is the process of identifying active hosts on the target network with the goal of creating a detailed schematic of the network infrastructure.
* Post Scanning
	* Port scanning the process of probing the target with specific TCP flags with the aim of enumerating the running services and their respective ports based on the responses from the target.**

***TCP Flags***

* *TCP flags are found in the TCP header and are responsibile for the transmission and flow of packets across the network.* 
* *Port scanning involves the use of specially crafted TCP flags in packets to determine the targets OS, service versions and check for the presence of packet filtering or a firewall.*

* **URG(Urgent) - Packet to be preocessed immediately**
* **PSH(Push) - Transmits data immediately**
* **FIN(Finish) - No further transmission**
* **ACK(Acknowledgement) - Acknowledges receipt of packet**
* **SYN(Synchronization) - Initializes connection between host and target**
* **RST(Reset) - Resets the connection**

**TCP 3-Way Handshake**

**Client** -> *State changes to `SYN-SENT`* => **`SYN seq:100`**
**Server** -> *State changes to `SYN-RECEIVED`* => **`SYN-ACK seq:200 ack:101`**
**Client** -> *State changes to `ESTABLISHED`* => **`ACK seq:101 ack:201`**
**Server** -> *State changes to `ESTABLISHED`* 

### 7.1.2 TCP-3 Way Handshake Explained

*To scan the TCP services => UDP with `-sU`*
```sh
nmap -sT 172.20.10.13
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-23 22:43 EDT
Nmap scan report for localhost (172.20.10.13)
Host is up (0.00085s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 0.18 seconds
```

## 7.2 Nmap

### 7.2.1 Nmap - Host Discovery with Ping Sweep

```sh
nmap scanme.nmap.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 11:01 CST
Nmap scan report for scanme.nmap.org (45.33.32.156)
Host is up (0.20s latency).
Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
Not shown: 990 closed ports
PORT      STATE    SERVICE
21/tcp    open     ftp
22/tcp    open     ssh
80/tcp    filtered http
135/tcp   filtered msrpc
139/tcp   filtered netbios-ssn
445/tcp   filtered microsoft-ds
593/tcp   filtered http-rpc-epmap
4444/tcp  filtered krb524
9929/tcp  open     nping-echo
31337/tcp open     Elite

Nmap done: 1 IP address (1 host up) scanned in 29.04 seconds
```

```sh
nmap -sn 172.20.10.1
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 11:02 CST
Nmap scan report for _gateway (172.20.10.1)
Host is up (0.0011s latency).
Nmap done: 1 IP address (1 host up) scanned in 3.60 seconds
```

```sh
nmap -sn 172.20.10.1/24
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 11:03 CST
Nmap scan report for _gateway (172.20.10.1)
Host is up (0.0011s latency).
Nmap scan report for localhost (172.20.10.4)
Host is up (0.00092s latency).
Nmap scan report for localhost (172.20.10.13)
Host is up (0.00015s latency).
Nmap done: 256 IP addresses (3 hosts up) scanned in 6.50 seconds
```

```sh
man nmap | grep sn
`=>
-sn: Ping Scan - disable port scan
nmap -v -sn 192.168.0.0/16 10.0.0.0/8
Everything on the Nmap command-line that isn't an option (or option
specification doesn't look like a command-line option. Ranges need not be about the -sn option to learn how to perform only host discovery, or use
-sn (No port scan)
The default host discovery done with -sn consists of an ICMP echo specified. The -sn option can be combined with any of the discovery 
In previous releases of Nmap, -sn was known as -sP.
options -Pn -sn together.
```

```sh
man nmap | grep -i Pn
`=>
-Pn: Treat all hosts as online -- skip host discovery
nmap -v -iR 10000 -Pn -p 80
nmap -Pn -sS -p 80 -iR 0 --open to locate random web servers for
discovery (-Pn), or engage the network with arbitrary combinations of
-Pn to skip host discovery and port scan all target addresses. The functionality, read up on the -Pn (skip host discovery) option.
-Pn (No ping)
-Pn causes Nmap to attempt the requested scanning functions against
options -Pn -sn together. previous versions of Nmap, -Pn was -P0 and -PN.
options such as -Pn or -PE are used. To disable this implicit
```

```sh
nmap -Pn 172.20.10.1/24 -v
`=>
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 11:10 CST
Initiating Parallel DNS resolution of 256 hosts. at 11:10
Completed Parallel DNS resolution of 256 hosts. at 11:10, 15.13s elapsed
Initiating Connect Scan at 11:10
Scanning 64 hosts [1000 ports/host]
Discovered open port 22/tcp on 172.20.10.13
Discovered open port 80/tcp on 172.20.10.13
Discovered open port 53/tcp on 172.20.10.1
Discovered open port 21/tcp on 172.20.10.1
Completed Connect Scan against 172.20.10.0 in 0.49s (63 hosts left)
Completed Connect Scan against 172.20.10.4 in 0.49s (62 hosts left)
Completed Connect Scan against 172.20.10.13 in 0.49s (61 hosts left)
Completed Connect Scan against 172.20.10.15 in 0.49s (60 hosts left)
Discovered open port 21/tcp on 172.20.10.59
Discovered open port 21/tcp on 172.20.10.19
Discovered open port 21/tcp on 172.20.10.23
Increasing send delay for 172.20.10.1 from 0 to 5 due to max_successful_tryno increase to 4
Connect Scan Timing: About 9.28% done; ETC: 11:15 (0:05:03 remaining)
......
```

### 7.2.2 Nmap - OS and Service Version Scanning

```sh
nmap -sn 172.20.10.1/24
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 13:27 CST
Nmap scan report for _gateway (172.20.10.1)
Host is up (0.0010s latency).
Nmap scan report for lawjune-ThinkPad-T530 (172.20.10.13)
Host is up (0.00011s latency).
Nmap done: 256 IP addresses (2 hosts up) scanned in 6.10 seconds
```

```sh
sudo nmap -O 172.20.10.13
`=>
[sudo] password for lawjune: 
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 13:29 CST
Nmap scan report for lawjune-ThinkPad-T530 (172.20.10.13)
Host is up (0.000072s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6.32
OS details: Linux 2.6.32
Network Distance: 0 hops

OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1.80 seconds
```

```sh
sudo nmap -O -sV 172.20.10.13
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 13:32 CST
Nmap scan report for lawjune-ThinkPad-T530 (172.20.10.13)
Host is up (0.000084s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 6 (protocol 2.0)
80/tcp open  http    Apache httpd 2.4.48 ((Debian))
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=9/24%OT=22%CT=1%CU=37233%PV=Y%DS=0%DC=L%G=Y%TM=614D62E
OS:B%P=x86_64-pc-linux-gnu)SEQ(SP=109%GCD=1%ISR=10B%TI=Z%CI=Z%II=I%TS=A)OPS
OS:(O1=MFFD7ST11NW7%O2=MFFD7ST11NW7%O3=MFFD7NNT11NW7%O4=MFFD7ST11NW7%O5=MFF
OS:D7ST11NW7%O6=MFFD7ST11)WIN(W1=FFCB%W2=FFCB%W3=FFCB%W4=FFCB%W5=FFCB%W6=FF
OS:CB)ECN(R=Y%DF=Y%T=40%W=FFD7%O=MFFD7NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A
OS:=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%
OS:Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=
OS:A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=
OS:Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%
OS:T=40%CD=S)

Network Distance: 0 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 18.36 seconds
```

```sh
sudo nmap -O 172.20.10.1
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 13:39 CST
Nmap scan report for _gateway (172.20.10.1)
Host is up (0.00081s latency).
Not shown: 997 closed ports
PORT      STATE SERVICE
21/tcp    open  ftp
53/tcp    open  domain
62078/tcp open  iphone-sync
MAC Address: 16:D0:0D:AE:91:64 (Unknown)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=9/24%OT=21%CT=1%CU=33519%PV=Y%DS=1%DC=D%G=Y%M=16D00D%T
OS:M=614D64C3%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10C%TI=Z%CI=RI%II=
OS:RI%TS=A)SEQ(SP=108%GCD=1%ISR=108%TI=Z%II=RI%TS=A)OPS(O1=M582NW6NNT11SLL%
OS:O2=M582NW6NNT11SLL%O3=M582NW6NNT11%O4=M582NW6NNT11SLL%O5=M582NW6NNT11SLL
OS:%O6=M582NNT11SLL)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6=FFFF)ECN
OS:(R=Y%DF=N%T=40%W=FFFF%O=M582NW6SLL%CC=Y%Q=)T1(R=Y%DF=N%T=40%S=O%A=S+%F=A
OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=N%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=
OS:0%Q=)T6(R=Y%DF=N%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T6(R=N)T7(R=N)U1(R=Y%DF
OS:=N%T=40%IPL=38%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=0%RUD=G)IE(R=Y%DFI=N%T=40%
OS:CD=S)

Network Distance: 1 hop

OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 52.86 seconds
```

```sh
sudo nmap -O -sV 172.20.10.1
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 13:33 CST
Nmap scan report for _gateway (172.20.10.1)
Host is up (0.00071s latency).
Not shown: 997 closed ports
PORT      STATE SERVICE    VERSION
21/tcp    open  ftp?
53/tcp    open  domain     (generic dns response: NOTIMP)
62078/tcp open  tcpwrapped
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port53-TCP:V=7.91%I=7%D=9/24%Time=614D635E%P=x86_64-pc-linux-gnu%r(DNSV
SF:ersionBindReqTCP,6B,"\0i\0\x06\x81\x83\0\x01\0\0\0\x01\0\0\x07version\x
SF:04bind\0\0\x10\0\x01\0\0\x06\0\x01\0\0\0<\0@\x01a\x0croot-servers\x03ne
SF:t\0\x05nstld\x0cverisign-grs\x03com\0xwl0\0\0\x07\x08\0\0\x03\x84\0\t:\
SF:x80\0\x01Q\x80")%r(DNSStatusRequestTCP,E,"\0\x0c\0\0\x90\x04\0\0\0\0\0\
SF:0\0\0");
MAC Address: 16:D0:0D:AE:91:64 (Unknown)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=9/24%OT=21%CT=1%CU=30617%PV=Y%DS=1%DC=D%G=Y%M=16D00D%T
OS:M=614D6401%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=108%TI=Z%CI=RI%II=
OS:RI%TS=A)OPS(O1=M582NW6NNT11SLL%O2=M582NW6NNT11SLL%O3=M582NW6NNT11%O4=M58
OS:2NW6NNT11SLL%O5=M582NW6NNT11SLL%O6=M582NNT11SLL)WIN(W1=FFFF%W2=FFFF%W3=F
OS:FFF%W4=FFFF%W5=FFFF%W6=FFFF)ECN(R=Y%DF=N%T=40%W=FFFF%O=M582NW6SLL%CC=Y%Q
OS:=)T1(R=Y%DF=N%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=
OS:N%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=N%T=40%W=0%S=A%A=Z%F=R%O=%
OS:RD=0%Q=)T7(R=N)U1(R=Y%DF=N%T=40%IPL=38%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=0%
OS:RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Network Distance: 1 hop

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 208.96 seconds
```

### 7.2.3 Nmap - TCP Connection & Stealth (SYN) Scanning

```sh
nmap -sn 172.20.10.1/24
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 01:47 EDT
Nmap scan report for 172.20.10.1
Host is up (0.0013s latency).
MAC Address: 16:D0:0D:AE:91:64 (Unknown)
Nmap scan report for 172.20.10.2
Host is up (0.00069s latency).
MAC Address: 6C:88:14:02:68:78 (Intel Corporate)
Nmap scan report for 172.20.10.5
Host is up (0.070s latency).
MAC Address: 04:B1:67:A8:C3:CB (Xiaomi Communications)
Nmap scan report for 172.20.10.13
Host is up (0.00050s latency).
MAC Address: 6C:88:14:02:68:78 (Intel Corporate)
Nmap scan report for localhost (172.20.10.4)
Host is up.
```

```sh
nmap -sT 172.20.10.13 -p 20-8080
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 13:49 CST
Nmap scan report for lawjune-ThinkPad-T530 (172.20.10.13)
Host is up (0.00012s latency).
Not shown: 8059 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 0.27 seconds
```

```sh
sudo nmap -sS 172.20.10.13
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 13:52 CST
Nmap scan report for lawjune-ThinkPad-T530 (172.20.10.13)
Host is up (0.0000060s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 0.23 seconds
```

**Check the pcap via WireShark**

### 7.2.4 Nmap - UDP Scanning

### 7.2.5 Nmap - Output and Verbosity

```sh
an nmap | grep -i OUTPUT
`=>
       The output from Nmap is a list of scanned targets, with
           OUTPUT:
             -oN/-oX/-oS/-oG <file>: Output scan in normal, XML, s|<rIpt kIddi3,
             -oA <basename>: Output in the three major formats at once
             --append-output: Append to rather than clobber specified output files
             --stylesheet <path/URL>: XSL stylesheet to transform XML output to HTML
             --no-stylesheet: Prevent associating of XSL stylesheet w/XML output
```

```sh
sudo nmap -sS -vvv scanme.nmap.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 15:55 CST
Warning: Hostname scanme.nmap.org resolves to 2 IPs. Using 45.33.32.156.
Initiating Ping Scan at 15:55
Scanning scanme.nmap.org (45.33.32.156) [4 ports]
Completed Ping Scan at 15:55, 0.25s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 15:55
Completed Parallel DNS resolution of 1 host. at 15:55, 0.00s elapsed
DNS resolution of 1 IPs took 0.00s. Mode: Async [#: 1, OK: 1, NX: 0, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating SYN Stealth Scan at 15:55
Scanning scanme.nmap.org (45.33.32.156) [1000 ports]
Discovered open port 21/tcp on 45.33.32.156
Discovered open port 80/tcp on 45.33.32.156
Discovered open port 22/tcp on 45.33.32.156
Increasing send delay for 45.33.32.156 from 0 to 5 due to 29 out of 95 dropped probes since last increase.
Discovered open port 31337/tcp on 45.33.32.156
Discovered open port 9929/tcp on 45.33.32.156
Completed SYN Stealth Scan at 15:55, 13.09s elapsed (1000 total ports)
Nmap scan report for scanme.nmap.org (45.33.32.156)
Host is up, received reset ttl 50 (0.20s latency).
Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
Scanned at 2021-09-24 15:55:19 CST for 13s
Not shown: 990 closed ports
Reason: 990 resets
PORT      STATE    SERVICE        REASON
21/tcp    open     ftp            syn-ack ttl 64
22/tcp    open     ssh            syn-ack ttl 50
80/tcp    open     http           syn-ack ttl 49
135/tcp   filtered msrpc          no-response
139/tcp   filtered netbios-ssn    no-response
445/tcp   filtered microsoft-ds   no-response
593/tcp   filtered http-rpc-epmap no-response
4444/tcp  filtered krb524         no-response
9929/tcp  open     nping-echo     syn-ack ttl 49
31337/tcp open     Elite          syn-ack ttl 49

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 13.51 seconds
           Raw packets sent: 1060 (46.616KB) | Rcvd: 1060 (43.344KB)
```

### 7.2.6 Nmap - Inverse TCP Flag Scanning (FIN, XMAX & NULL)

```sh
nmap -sX 172.20.10.13
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 04:26 EDT
Nmap scan report for localhost (172.20.10.13)
Host is up (0.00011s latency).
Not shown: 998 closed ports
PORT   STATE         SERVICE
22/tcp open|filtered ssh
80/tcp open|filtered http
MAC Address: 16:D0:0D:EA:A8:1B (Unknown)
```

```sh
nmap -sF 172.20.10.13
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 04:27 EDT
Nmap scan report for localhost (172.20.10.13)
Host is up (0.00023s latency).
Not shown: 998 closed ports
PORT   STATE         SERVICE
22/tcp open|filtered ssh
80/tcp open|filtered http
MAC Address: 16:D0:0D:EA:A8:1B (Unknown)
```

```sh
nmap -sN 172.20.10.13 --reason
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 04:29 EDT
Nmap scan report for localhost (172.20.10.13)
Host is up, received arp-response (0.00019s latency).
Not shown: 998 closed ports
Reason: 998 resets
PORT   STATE         SERVICE REASON
22/tcp open|filtered ssh     no-response
80/tcp open|filtered http    no-response
MAC Address: 16:D0:0D:EA:A8:1B (Unknown)
```

```sh
nmap -sN 172.20.10.13 -p 8080 --reason
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 04:29 EDT
Nmap scan report for localhost (172.20.10.13)
Host is up, received arp-response (0.00045s latency).

PORT     STATE  SERVICE    REASON
8080/tcp closed http-proxy reset ttl 64
MAC Address: 16:D0:0D:EA:A8:1B (Unknown)
```

**Check the pcap via WireShark**

### 7.2.7 Nmap - Firewall Detection (ACK Probing)

**filtered**


# Section 8 - Network Penetration Testing (Sniffing, MITM, Wireshark, tcpdump, etc)

## 8.1 Introduction To Pentesting - Enumeration 

***Preparation: Setting Up NAT Network in VirtualBox***

```sh
netdiscover -i eth0 -r 172.20.10.0/24
```

```sh
nmap -sn 172.20.10.0/24
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-25 22:53 EDT
Nmap scan report for 172.20.10.1
Host is up (0.0015s latency).
MAC Address: 16:D0:0D:AE:91:64 (Unknown)
Nmap scan report for localhost (172.20.10.3)
Host is up (0.00038s latency).
MAC Address: 6C:88:14:02:68:78 (Intel Corporate)
Nmap scan report for localhost (172.20.10.5)
Host is up (0.00038s latency).
MAC Address: 08:00:27:CA:71:63 (Oracle VirtualBox virtual NIC)
Nmap scan report for 172.20.10.13
Host is up (0.00058s latency).
MAC Address: 6C:88:14:02:68:78 (Intel Corporate)
Nmap scan report for 172.20.10.4
Host is up.
```

*Not a good idea!*
```sh
nmap 172.20.10.5
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-25 22:55 EDT
Nmap scan report for localhost (172.20.10.5)
Host is up (0.00017s latency).
Not shown: 977 closed ports
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 08:00:27:CA:71:63 (Oracle VirtualBox virtual NIC)
```

```sh
nmap -sS -A -T4 -p-  172.20.10.5 
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-25 22:58 EDT
Nmap scan report for localhost (172.20.10.5)
Host is up (0.00068s latency).
Not shown: 65505 closed ports
PORT      STATE SERVICE     VERSION
21/tcp    open  ftp         vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 172.20.10.4
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
22/tcp    open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
23/tcp    open  telnet      Linux telnetd
25/tcp    open  smtp        Postfix smtpd
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 
|_ssl-date: 2021-09-26T03:01:33+00:00; +21s from scanner time.
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_RC2_128_CBC_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|_    SSL2_DES_64_CBC_WITH_MD5
53/tcp    open  domain      ISC BIND 9.4.2
| dns-nsid: 
|_  bind.version: 9.4.2
80/tcp    open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
|_http-title: Metasploitable2 - Linux
111/tcp   open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      47084/udp   mountd
|   100005  1,2,3      53459/tcp   mountd
|   100021  1,3,4      56624/tcp   nlockmgr
|   100021  1,3,4      58852/udp   nlockmgr
|   100024  1          45391/udp   status
|_  100024  1          58414/tcp   status
139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp   open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
512/tcp   open  exec        netkit-rsh rexecd
513/tcp   open  login       OpenBSD or Solaris rlogind
514/tcp   open  tcpwrapped
1099/tcp  open  java-rmi    GNU Classpath grmiregistry
1524/tcp  open  bindshell   Metasploitable root shell
2049/tcp  open  nfs         2-4 (RPC #100003)
2121/tcp  open  ftp         ProFTPD 1.3.1
3306/tcp  open  mysql       MySQL 5.0.51a-3ubuntu5
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 9
|   Capabilities flags: 43564
|   Some Capabilities: LongColumnFlag, Speaks41ProtocolNew, ConnectWithDatabase, SupportsTransactions, Support41Auth, SupportsCompression, SwitchToSSLAfterHandshake
|   Status: Autocommit
|_  Salt: PjE[ypEHwA}qA.`zgu7N
`=>
3632/tcp  open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))
5432/tcp  open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
|_ssl-date: 2021-09-26T03:01:33+00:00; +21s from scanner time.
5900/tcp  open  vnc         VNC (protocol 3.3)
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp  open  X11         (access denied)
6667/tcp  open  irc         UnrealIRCd
6697/tcp  open  irc         UnrealIRCd
8009/tcp  open  ajp13       Apache Jserv (Protocol v1.3)
|_ajp-methods: Failed to get a valid response for the OPTION request
8180/tcp  open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-favicon: Apache Tomcat
|_http-server-header: Apache-Coyote/1.1
|_http-title: Apache Tomcat/5.5
8787/tcp  open  drb         Ruby DRb RMI (Ruby 1.8; path /usr/lib/ruby/1.8/drb)
37434/tcp open  java-rmi    GNU Classpath grmiregistry
53459/tcp open  mountd      1-3 (RPC #100005)
56624/tcp open  nlockmgr    1-4 (RPC #100021)
58414/tcp open  status      1 (RPC #100024)
MAC Address: 08:00:27:CA:71:63 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h00m24s, deviation: 2h00m07s, median: 20s
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2021-09-25T23:01:25-04:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smb2-time: Protocol negotiation failed (SMB2)

TRACEROUTE
HOP RTT     ADDRESS
1   0.68 ms localhost (172.20.10.5)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 154.23 seconds
```

```sh
ls -al /usr/share/nmap/scripts | grep -e "ftp"
`=>
-rw-r--r-- 1 root root  4530 Oct 12  2020 ftp-anon.nse
-rw-r--r-- 1 root root  3253 Oct 12  2020 ftp-bounce.nse
-rw-r--r-- 1 root root  3108 Oct 12  2020 ftp-brute.nse
-rw-r--r-- 1 root root  3272 Oct 12  2020 ftp-libopie.nse
-rw-r--r-- 1 root root  3290 Oct 12  2020 ftp-proftpd-backdoor.nse
-rw-r--r-- 1 root root  3768 Oct 12  2020 ftp-syst.nse
-rw-r--r-- 1 root root  6021 Oct 12  2020 ftp-vsftpd-backdoor.nse
-rw-r--r-- 1 root root  5923 Oct 12  2020 ftp-vuln-cve2010-4221.nse
-rw-r--r-- 1 root root  5736 Oct 12  2020 tftp-enum.nse
```

```sh
nmap -sV -p 21 --script ftp-vsftpd-backdoor 172.20.10.5
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-25 23:07 EDT
Nmap scan report for localhost (172.20.10.5)
Host is up (0.00076s latency).

PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 2.3.4
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  CVE:CVE-2011-2523  BID:48539
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
|       https://www.securityfocus.com/bid/48539
|       http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
MAC Address: 08:00:27:CA:71:63 (Oracle VirtualBox virtual NIC)
Service Info: OS: Unix

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1.48 seconds
```

```sh
searchsploit vsftpd   
`=>  
------------------------------------------- ---------------------------------
 Exploit Title                             |  Path
------------------------------------------- ---------------------------------
vsftpd 2.0.5 - 'CWD' (Authenticated) Remot | linux/dos/5814.pl
vsftpd 2.0.5 - 'deny_file' Option Remote D | windows/dos/31818.sh
vsftpd 2.0.5 - 'deny_file' Option Remote D | windows/dos/31819.pl
vsftpd 2.3.2 - Denial of Service           | linux/dos/16270.c
vsftpd 2.3.4 - Backdoor Command Execution  | unix/remote/17491.rb
vsftpd 2.3.4 - Backdoor Command Execution  | unix/remote/49757.py
vsftpd 3.0.3 - Remote Denial of Service    | multiple/remote/49719.py
------------------------------------------- ---------------------------------
Shellcodes: No Results
```

***Switch the Metaploitable and Client network to NAT network***

```sh
apt install smtp-user-enum
```

```sh
smtp-user-enum -M VRFY -U /usr/share/wordlists/metasploit/unix_users.txt -t 10.0.2.4 
`=>
Starting smtp-user-enum v1.2 ( http://pentestmonkey.net/tools/smtp-user-enum )

 ----------------------------------------------------------
|                   Scan Information                       |
 ----------------------------------------------------------

Mode ..................... VRFY
Worker Processes ......... 5
Usernames file ........... /usr/share/wordlists/metasploit/unix_users.txt
Target count ............. 1
Username count ........... 168
Target TCP port .......... 25
Query timeout ............ 5 secs
Target domain ............ 

######## Scan started at Sun Sep 26 01:45:12 2021 #########
10.0.2.4: backup exists
10.0.2.4: bin exists
10.0.2.4: daemon exists
10.0.2.4: distccd exists
10.0.2.4: games exists
10.0.2.4: ftp exists
10.0.2.4: gnats exists
10.0.2.4: irc exists
10.0.2.4: libuuid exists
10.0.2.4: lp exists
10.0.2.4: list exists
10.0.2.4: mail exists
10.0.2.4: man exists
10.0.2.4: news exists
10.0.2.4: mysql exists
10.0.2.4: nobody exists
10.0.2.4: postfix exists
10.0.2.4: postgres exists
10.0.2.4: postmaster exists
10.0.2.4: proxy exists
10.0.2.4: root exists
10.0.2.4: ROOT exists
10.0.2.4: service exists
10.0.2.4: sshd exists
10.0.2.4: sync exists
10.0.2.4: sys exists
10.0.2.4: syslog exists
10.0.2.4: user exists
10.0.2.4: uucp exists
10.0.2.4: www-data exists
######## Scan completed at Sun Sep 26 01:45:25 2021 #########
30 results.

168 queries in 13 seconds (12.9 queries / sec)
```

```sh
smtp-user-enum -M VRFY -U /usr/share/wordlists/metasploit/[tab]
`=>
Completing file
adobe_top100_pass.txt                     named_pipes.txt                         
av_hips_executables.txt                   namelist.txt                            
av-update-urls.txt                        oracle_default_hashes.txt               
burnett_top_500.txt                       oracle_default_passwords.csv            
burnett_top_1024.txt                      oracle_default_userpass.txt             
can_flood_frames.txt                      password.lst                            
cms400net_default_userpass.txt            piata_ssh_userpass.txt                  
common_roots.txt                          postgres_default_pass.txt               
dangerzone_a.txt                          postgres_default_userpass.txt           
dangerzone_b.txt                          postgres_default_user.txt               
db2_default_pass.txt                      root_userpass.txt                       
db2_default_userpass.txt                  routers_userpass.txt                    
db2_default_user.txt                      rpc_names.txt                           
default_pass_for_services_unhash.txt      rservices_from_users.txt                
default_userpass_for_services_unhash.txt  sap_common.txt                          
default_users_for_services_unhash.txt     sap_default.txt                         
dlink_telnet_backdoor_userpass.txt        sap_icm_paths.txt                       
hci_oracle_passwords.csv                  scada_default_userpass.txt              
http_default_pass.txt                     sensitive_files.txt                     
http_default_userpass.txt                 sensitive_files_win.txt                 
http_default_users.txt                    sid.txt                                 
http_owa_common.txt                       snmp_default_pass.txt                   
idrac_default_pass.txt                    telerik_ui_asp_net_ajax_versions.txt    
idrac_default_user.txt                    telnet_cdata_ftth_backdoor_userpass.txt 
ipmi_passwords.txt                        tftp.txt                                
ipmi_users.txt                            tomcat_mgr_default_pass.txt             
joomla.txt                                tomcat_mgr_default_userpass.txt         
keyboard-patterns.txt                     tomcat_mgr_default_users.txt            
lync_subdomains.txt                       unix_passwords.txt                      
malicious_urls.txt                        unix_users.txt                          
mirai_pass.txt                            vnc_passwords.txt                       
mirai_user_pass.txt                       vxworks_collide_20.txt                  
mirai_user.txt                            vxworks_common_20.txt                   
multi_vendor_cctv_dvr_pass.txt            wp-plugins.txt                          
multi_vendor_cctv_dvr_users.txt           wp-themes.txt             
```

**Demo to crack the root password!**

```sh
msfadmin@metasploitable:~$ sudo passwd root
Enter new UNIX password:  -> "pudong01"
Retype new UNIX password: 
passwd: password updated successfully
```

```sh
msfadmin@metasploitable:~$ sudo cat /etc/shadow
`=>
root:$1$UicxHWDM$/mJ2DZ/wbwMsJ5E/9EZO/0:18896:0:99999:7:::
daemon:*:14684:0:99999:7:::
......(copy the above content to client file as shadow.txt)
```
=>
```sh
vim shadow.txt
```

```sh
msfadmin@metasploitable:~$ cat /etc/passwd
`=>
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
......(copy the above content to client file as passwd.txt)
```

```sh
vim passwd.txt
```

```sh
passwd.txt shadow.txt > hashes.txt
`=>
Created directory: /home/kali/.john
```

```sh
john --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt 
`=>
Warning: detected hash type "md5crypt", but the string is also recognized as "md5crypt-long"
Use the "--format=md5crypt-long" option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded 7 password hashes with 7 different salts (md5crypt, crypt(3) $1$ (and variants) [MD5 128/128 AVX 4x3])
Press 'q' or Ctrl-C to abort, almost any other key for status
123456789        (klog)
batman           (sys)
service          (service)
3g 0:00:00:45 2.73% (ETA: 03:18:59) 0.06557g/s 9952p/s 40015c/s 40015C/s window8..windbreaker
Use the "--show" option to display all of the cracked passwords reliably
Session aborted
```

```sh
map -sV -p 80 --script http-enum 10.0.2.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-26 03:02 EDT
Nmap scan report for 10.0.2.4
Host is up (0.0021s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.2.8 ((Ubuntu) DAV/2)
| http-enum: 
|   /tikiwiki/: Tikiwiki
|   /test/: Test page
|   /phpinfo.php: Possible information file
|   /phpMyAdmin/: phpMyAdmin
|   /doc/: Potentially interesting directory w/ listing on 'apache/2.2.8 (ubuntu) dav/2'
|   /icons/: Potentially interesting folder w/ directory listing
|_  /index/: Potentially interesting folder
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.35 seconds
```

## 8.2 Nmap - Firewall Evasion (Decoys, MTU & Fragmentation)

### Decoys

***Open the WireShark***

```sh
`=>
-sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans

-sV: Probe open ports to determine service/version info

-F: Fast mode - Scan fewer ports than the default scan

-D <decoy1,decoy2[,ME],...>: Cloak a scan with decoys
```

```sh
nmap -sS -sV -F -D RND:3 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 09:05 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.21s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 94 closed ports
PORT    STATE    SERVICE      VERSION
21/tcp  open     tcpwrapped
22/tcp  open     ssh          OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)
80/tcp  open     ssl/http     Apache/2.4.7 (Ubuntu)
135/tcp filtered msrpc
139/tcp filtered netbios-ssn
445/tcp filtered microsoft-ds
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 94.48 seconds
```

```sh
nmap -sS -sV -F -D 174.139.202.101 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 09:17 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.20s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 94 closed ports
PORT    STATE    SERVICE      VERSION
21/tcp  open     tcpwrapped
22/tcp  open     ssh          OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)
80/tcp  open     http         Apache httpd 2.4.7 ((Ubuntu))
135/tcp filtered msrpc
139/tcp filtered netbios-ssn
445/tcp filtered microsoft-ds
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.73 seconds
```

### Fragmentation

```sh
`=>
-f; --mtu <val>: fragment packets (optionally w/given MTU)
```

*Use `-f` to replace `-F`*

```sh
nmap -sS -sV -f -D 174.139.202.101 nmap.scanme.org
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 09:22 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.19s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 990 closed ports
PORT      STATE    SERVICE        VERSION
21/tcp    open     tcpwrapped
22/tcp    open     ssh            OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)
80/tcp    open     http           Apache httpd 2.4.7 ((Ubuntu))
135/tcp   filtered msrpc
139/tcp   filtered netbios-ssn
445/tcp   filtered microsoft-ds
593/tcp   filtered http-rpc-epmap
4444/tcp  filtered krb524
9929/tcp  open     nping-echo     Nping echo
31337/tcp open     tcpwrapped
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 23.19 seconds
```

*We can see the `Fragmented IP protocol` with 8 bytes via `IPv4` sent from client to target.*

### MTU (Minimu Transmission Uniy)

```sh
nmap -sS -sV -F -mtu 16 -D 174.139.202.101 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 10:22 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.24s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 94 closed ports
PORT    STATE    SERVICE      VERSION
21/tcp  open     tcpwrapped
22/tcp  open     ssh          OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)
80/tcp  open     http         Apache httpd 2.4.7 ((Ubuntu))
135/tcp filtered msrpc
139/tcp filtered netbios-ssn
445/tcp filtered microsoft-ds
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.70 seconds
```

```sh
nmap -sS -sV -F -mtu 16 --send-eth -D 174.139.202.101 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 10:25 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.24s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 94 closed ports
PORT    STATE    SERVICE      VERSION
21/tcp  open     tcpwrapped
22/tcp  open     ssh          OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)
80/tcp  open     http         Apache httpd 2.4.7 ((Ubuntu))
135/tcp filtered msrpc
139/tcp filtered netbios-ssn
445/tcp filtered microsoft-ds
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.19 seconds
```

```sh
nmap -sS -sV -F -mtu 24 --send-eth -D 174.139.202.101 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 10:26 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.23s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 94 closed ports
PORT    STATE    SERVICE      VERSION
21/tcp  open     tcpwrapped
22/tcp  open     ssh          OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)
80/tcp  open     http         Apache httpd 2.4.7 ((Ubuntu))
135/tcp filtered msrpc
139/tcp filtered netbios-ssn
445/tcp filtered microsoft-ds
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.48 seconds
```

## 8.3 Nmap - Scan Timming and Performance

### 8.3.1 Timming Templates

https://nmap.org/book/performance-timing-templates.html

```sh
nmap -nP -T4 -sS -p21-80 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 10:42 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.25s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
Not shown: 57 closed ports
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 1.25 seconds
```

```sh
nmap -nP -T2 -sS -p21-80 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 10:43 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.23s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
Not shown: 57 closed ports
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 25.01 seconds
```

### 8.3.2 Parallelism

***--min-parallelism***

```sh
nmap -sS -p21-443 --min-parallelism 30 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 10:50 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.21s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 414 closed ports
PORT    STATE    SERVICE
21/tcp  open     ftp
22/tcp  open     ssh
80/tcp  open     http
123/tcp filtered ntp
135/tcp filtered msrpc
136/tcp filtered profile
137/tcp filtered netbios-ns
138/tcp filtered netbios-dgm
139/tcp filtered netbios-ssn

Nmap done: 1 IP address (1 host up) scanned in 4.95 seconds
```

```sh
nmap -sS -p21-443 --min-parallelism 50 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 10:50 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.22s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 414 closed ports
PORT    STATE    SERVICE
21/tcp  open     ftp
22/tcp  open     ssh
80/tcp  open     http
123/tcp filtered ntp
135/tcp filtered msrpc
136/tcp filtered profile
137/tcp filtered netbios-ns
138/tcp filtered netbios-dgm
139/tcp filtered netbios-ssn

Nmap done: 1 IP address (1 host up) scanned in 4.12 seconds
```

```sh
nmap -sS -p21-443 --min-parallelism 10 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 10:51 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.27s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 414 closed ports
PORT    STATE    SERVICE
21/tcp  open     ftp
22/tcp  open     ssh
80/tcp  open     http
123/tcp filtered ntp
135/tcp filtered msrpc
136/tcp filtered profile
137/tcp filtered netbios-ns
138/tcp filtered netbios-dgm
139/tcp filtered netbios-ssn

Nmap done: 1 IP address (1 host up) scanned in 8.43 seconds
```

***--max-parallelism***

```sh
nmap -sS -p21-443 --max-parallelism 10 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 10:52 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.21s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 414 closed ports
PORT    STATE    SERVICE
21/tcp  open     ftp
22/tcp  open     ssh
80/tcp  open     http
123/tcp filtered ntp
135/tcp filtered msrpc
136/tcp filtered profile
137/tcp filtered netbios-ns
138/tcp filtered netbios-dgm
139/tcp filtered netbios-ssn

Nmap done: 1 IP address (1 host up) scanned in 12.45 seconds
```

```sh
nmap -sS -p21-443 --max-parallelism 30 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 10:53 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.21s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 414 closed ports
PORT    STATE    SERVICE
21/tcp  open     ftp
22/tcp  open     ssh
80/tcp  open     http
123/tcp filtered ntp
135/tcp filtered msrpc
136/tcp filtered profile
137/tcp filtered netbios-ns
138/tcp filtered netbios-dgm
139/tcp filtered netbios-ssn

Nmap done: 1 IP address (1 host up) scanned in 6.68 seconds
```

**Do NOT recomment to use parallelism**

### 8.3.3 Host Group Sizes

```sh
nmap -sS -F --min-hostgroup 30 10.0.2.1/24
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-26 22:58 EDT
Nmap scan report for 10.0.2.1
Host is up (0.000082s latency).
Not shown: 99 closed ports
PORT   STATE SERVICE
53/tcp open  domain
MAC Address: 52:54:00:12:35:00 (QEMU virtual NIC)

Nmap scan report for localhost (10.0.2.2)
Host is up (0.00016s latency).
Not shown: 97 closed ports
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
631/tcp open  ipp
MAC Address: 52:54:00:12:35:00 (QEMU virtual NIC)

Nmap scan report for 10.0.2.3
Host is up (0.000081s latency).
All 100 scanned ports on 10.0.2.3 are filtered
MAC Address: 08:00:27:8A:1A:8E (Oracle VirtualBox virtual NIC)

Nmap scan report for 10.0.2.4
Host is up (0.00013s latency).
Not shown: 82 closed ports
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
513/tcp  open  login
514/tcp  open  shell
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
8009/tcp open  ajp13
MAC Address: 08:00:27:CA:71:63 (Oracle VirtualBox virtual NIC)

Nmap scan report for 10.0.2.5
Host is up (0.0000080s latency).
All 100 scanned ports on 10.0.2.5 are closed

Nmap done: 256 IP addresses (5 hosts up) scanned in 15.17 seconds
```

### 8.3.4 Host Timeout

```sh
nmap -Pn -p- 10.2.1-255.1-255 --host-timeout 30s 
```

### 8.3.5 Scan Delays

```sh
nmap --scan-delay 5s nmap.scanme.org
```

*To check the WireShark the internal as 5 seconds for each TCP SYNC*

### 8.3.6 Packet Rate

**20 packets per second**
```sh
nmap -sT --min-rate 20 nmap.scanme.org
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 11:11 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.21s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 990 closed ports
PORT      STATE    SERVICE
21/tcp    open     ftp
22/tcp    open     ssh
80/tcp    open     http
135/tcp   filtered msrpc
139/tcp   filtered netbios-ssn
445/tcp   filtered microsoft-ds
593/tcp   filtered http-rpc-epmap
4444/tcp  filtered krb524
9929/tcp  open     nping-echo
31337/tcp open     Elite

Nmap done: 1 IP address (1 host up) scanned in 8.31 seconds
```

***More accurate and reasonal result***

```sh
nmap -sT --max-rate 2 nmap.scanme.org
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 11:12 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.22s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org
Not shown: 990 closed ports
PORT      STATE    SERVICE
21/tcp    open     ftp
22/tcp    open     ssh
80/tcp    open     http
135/tcp   filtered msrpc
139/tcp   filtered netbios-ssn
445/tcp   filtered microsoft-ds
593/tcp   filtered http-rpc-epmap
4444/tcp  filtered krb524
9929/tcp  open     nping-echo
31337/tcp open     Elite

Nmap done: 1 IP address (1 host up) scanned in 509.10 seconds
```

## 8.4 Nmap - Introduction to the Nmap Scripting Engine (NSE)

https://nmap.org/book/nse.html 

```sh
ls -al /usr/share/nmap/scripts/
`=>
total 4944 -> all the nmap scripts
drwxr-xr-x 2 root root 36864 9月  17 21:39 .
drwxr-xr-x 4 root root  4096 9月  17 21:39 ..
-rw-r--r-- 1 root root  3901 10月 12  2020 acarsd-info.nse
-rw-r--r-- 1 root root  8724 10月 12  2020 address-info.nse
-rw-r--r-- 1 root root  3345 10月 12  2020 afp-brute.nse
-rw-r--r-- 1 root root  6463 10月 12  2020 afp-ls.nse
-rw-r--r-- 1 root root  7001 10月 12  2020 afp-path-vuln.nse
-rw-r--r-- 1 root root  5600 10月 12  2020 afp-serverinfo.nse
-rw-r--r-- 1 root root  2621 10月 12  2020 afp-showmount.nse
-rw-r--r-- 1 root root  2262 10月 12  2020 ajp-auth.nse
-rw-r--r-- 1 root root  2983 10月 12  2020 ajp-brute.nse
-rw-r--r-- 1 root root  1329 10月 12  2020 ajp-headers.nse
-rw-r--r-- 1 root root  2590 10月 12  2020 ajp-methods.nse
-rw-r--r-- 1 root root  3051 10月 12  2020 ajp-request.nse
-rw-r--r-- 1 root root  6719 10月 12  2020 allseeingeye-info.nse
-rw-r--r-- 1 root root  1678 10月 12  2020 amqp-info.nse
-rw-r--r-- 1 root root 15024 10月 12  2020 asn-query.nse
-rw-r--r-- 1 root root  2054 10月 12  2020 auth-owners.nse
-rw-r--r-- 1 root root   870 10月 12  2020 auth-spoof.nse
-rw-r--r-- 1 root root  9050 10月 12  2020 backorifice-brute.nse
-rw-r--r-- 1 root root 10193 10月 12  2020 backorifice-info.nse
-rw-r--r-- 1 root root 53137 10月 12  2020 bacnet-info.nse
-rw-r--r-- 1 root root  6136 10月 12  2020 banner.nse
```

```sh
ls -al /usr/share/nmap/scripts/ | grep -e http-enum
`=>
-rw-r--r-- 1 root root 20667 10月 12  2020 http-enum.nse
```

## 8.5 Nmap - NSE Syntax

```sh
sudo nmap --script-updatedb 
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 16:46 CST
NSE: Updating rule database.
NSE: Script Database updated successfully.
Nmap done: 0 IP addresses (0 hosts up) scanned in 0.76 seconds
```

```sh
nmap -sn 192.168.1.4
`=>                      
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 04:57 EDT
Nmap scan report for 192.168.1.4
Host is up (0.0031s latency).
Nmap done: 1 IP address (1 host up) scanned in 3.60 seconds
```

```sh
nmap -sV 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 04:58 EDT
Nmap scan report for 192.168.1.4
Host is up (0.00072s latency).
Not shown: 977 closed ports
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
53/tcp   open  domain      ISC BIND 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
111/tcp  open  rpcbind     2 (RPC #100000)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.04 seconds
```

```sh
ls -al /usr/share/nmap/scripts | grep -e ftp
`=>
-rw-r--r-- 1 root root  4530 Oct 12  2020 ftp-anon.nse
-rw-r--r-- 1 root root  3253 Oct 12  2020 ftp-bounce.nse
-rw-r--r-- 1 root root  3108 Oct 12  2020 ftp-brute.nse
-rw-r--r-- 1 root root  3272 Oct 12  2020 ftp-libopie.nse
-rw-r--r-- 1 root root  3290 Oct 12  2020 ftp-proftpd-backdoor.nse
-rw-r--r-- 1 root root  3768 Oct 12  2020 ftp-syst.nse
-rw-r--r-- 1 root root  6021 Oct 12  2020 ftp-vsftpd-backdoor.nse
-rw-r--r-- 1 root root  5923 Oct 12  2020 ftp-vuln-cve2010-4221.nse
-rw-r--r-- 1 root root  5736 Oct 12  2020 tftp-enum.nse
```

```sh
nmap -p 21  --script ftp-anon 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 05:01 EDT
Nmap scan report for 192.168.1.4
Host is up (0.00054s latency).

PORT   STATE SERVICE
21/tcp open  ftp
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)

Nmap done: 1 IP address (1 host up) scanned in 0.35 seconds
```

```sh
ftp 192.168.1.4
`=>
Connected to 192.168.1.4.
220 (vsFTPd 2.3.4)
Name (192.168.1.4:kali): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
226 Directory send OK.
ftp>
```

```sh
nmap -p 21  --script ftp-anon,ftp-vsftpd-backdoor 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 05:03 EDT
Nmap scan report for 192.168.1.4
Host is up (0.00056s latency).

PORT   STATE SERVICE
21/tcp open  ftp
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  CVE:CVE-2011-2523  BID:48539
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       https://www.securityfocus.com/bid/48539
|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
|       http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523

Nmap done: 1 IP address (1 host up) scanned in 1.33 seconds
```

```sh
nmap -p 21  --script "ftp-*" 192.168.1.4
```

## 8.6 Nmap - Banner Grabbing

```sh
nmap -p22,80 --script banner 192.168.1.4
`=>        
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 20:18 EDT
Nmap scan report for localhost (192.168.1.4)
Host is up (0.00061s latency).

PORT   STATE SERVICE
22/tcp open  ssh
|_banner: SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1
80/tcp open  http
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 13.87 seconds
```

```sh
nmap -F -T4 --script banner 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 20:19 EDT
Nmap scan report for localhost (192.168.1.4)
Host is up (0.00013s latency).
Not shown: 82 closed ports
PORT     STATE SERVICE
21/tcp   open  ftp
|_banner: 220 (vsFTPd 2.3.4)
22/tcp   open  ssh
|_banner: SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
513/tcp  open  login
514/tcp  open  shell
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
| banner: >\x00\x00\x00\x0A5.0.51a-3ubuntu5\x00\x09\x00\x00\x00E;9KM"`=\x
|_00,\xAA\x08\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\...
5432/tcp open  postgresql
5900/tcp open  vnc
|_banner: RFB 003.003
6000/tcp open  X11
8009/tcp open  ajp13
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 15.35 seconds
```

## 8.7 Nmap - FTP Enumeration

```sh
ls -al /usr/share/nmap/scripts | grep -e ftp
`=>
-rw-r--r-- 1 root root  4530 Oct 12  2020 ftp-anon.nse
-rw-r--r-- 1 root root  3253 Oct 12  2020 ftp-bounce.nse
-rw-r--r-- 1 root root  3108 Oct 12  2020 ftp-brute.nse
-rw-r--r-- 1 root root  3272 Oct 12  2020 ftp-libopie.nse
-rw-r--r-- 1 root root  3290 Oct 12  2020 ftp-proftpd-backdoor.nse
-rw-r--r-- 1 root root  3768 Oct 12  2020 ftp-syst.nse
-rw-r--r-- 1 root root  6021 Oct 12  2020 ftp-vsftpd-backdoor.nse
-rw-r--r-- 1 root root  5923 Oct 12  2020 ftp-vuln-cve2010-4221.nse
-rw-r--r-- 1 root root  5736 Oct 12  2020 tftp-enum.nse
```

```sh
nmap -sV -p 21  192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 20:45 EDT
Nmap scan report for localhost (192.168.1.4)
Host is up (0.00063s latency).

PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 2.3.4
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)
Service Info: OS: Unix

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 0.45 seconds
```

https://nmap.org/nsedoc/scripts/ftp-vuln-cve2010-4221.html

```sh
nmap -p 21  -sS --script ftp-anon,ftp-syst,tftp-enum,ftp-vsftpd-backdoor 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 20:55 EDT
Nmap scan report for localhost (192.168.1.4)
Host is up (0.00058s latency).

PORT   STATE SERVICE
21/tcp open  ftp
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.1.5
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  BID:48539  CVE:CVE-2011-2523
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
|       https://www.securityfocus.com/bid/48539
|       http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.33 seconds
```

## 8.8 Nmap - DNS Enumeration

```sh
ls -al /usr/share/nmap/scripts | grep -e dns 
`=>
-rw-r--r-- 1 root root  1499 Oct 12  2020 broadcast-dns-service-discovery.nse
-rw-r--r-- 1 root root  5329 Oct 12  2020 dns-blacklist.nse
-rw-r--r-- 1 root root 10100 Oct 12  2020 dns-brute.nse
-rw-r--r-- 1 root root  6639 Oct 12  2020 dns-cache-snoop.nse
-rw-r--r-- 1 root root 15152 Oct 12  2020 dns-check-zone.nse
-rw-r--r-- 1 root root 14826 Oct 12  2020 dns-client-subnet-scan.nse
-rw-r--r-- 1 root root 10168 Oct 12  2020 dns-fuzz.nse
-rw-r--r-- 1 root root  3803 Oct 12  2020 dns-ip6-arpa-scan.nse
-rw-r--r-- 1 root root 12702 Oct 12  2020 dns-nsec3-enum.nse
-rw-r--r-- 1 root root 10580 Oct 12  2020 dns-nsec-enum.nse
-rw-r--r-- 1 root root  3441 Oct 12  2020 dns-nsid.nse
-rw-r--r-- 1 root root  4364 Oct 12  2020 dns-random-srcport.nse
-rw-r--r-- 1 root root  4363 Oct 12  2020 dns-random-txid.nse
-rw-r--r-- 1 root root  1456 Oct 12  2020 dns-recursion.nse
-rw-r--r-- 1 root root  2195 Oct 12  2020 dns-service-discovery.nse
-rw-r--r-- 1 root root  5679 Oct 12  2020 dns-srv-enum.nse
-rw-r--r-- 1 root root  5765 Oct 12  2020 dns-update.nse
-rw-r--r-- 1 root root  2123 Oct 12  2020 dns-zeustracker.nse
-rw-r--r-- 1 root root 26574 Oct 12  2020 dns-zone-transfer.nse
-rw-r--r-- 1 root root  3910 Oct 12  2020 fcrdns.nse
```

https://github.com/danielmiessler/SecLists/blob/master/Discovery/DNS/fierce-hostlist.txt

### 8.8.1 dns-zone-transfer

```sh
nmap --script dns-zone-transfer --script-args dns-zone-transfer.server=nsztm1.digi.ninja,dns-zone-transfer.domain=zonetransfer.me
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 21:22 EDT
Pre-scan script results:
| dns-zone-transfer: 
| zonetransfer.me.                                SOA    nsztm1.digi.ninja. robin.digi.ninja.
| zonetransfer.me.                                HINFO  "Casio fx-700G" "Windows XP"
| zonetransfer.me.                                TXT    "google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA"
| zonetransfer.me.                                MX     0 ASPMX.L.GOOGLE.COM.
| zonetransfer.me.                                MX     10 ALT1.ASPMX.L.GOOGLE.COM.
| zonetransfer.me.                                MX     10 ALT2.ASPMX.L.GOOGLE.COM.
| zonetransfer.me.                                MX     20 ASPMX2.GOOGLEMAIL.COM.
| zonetransfer.me.                                MX     20 ASPMX3.GOOGLEMAIL.COM.
| zonetransfer.me.                                MX     20 ASPMX4.GOOGLEMAIL.COM.
| zonetransfer.me.                                MX     20 ASPMX5.GOOGLEMAIL.COM.
| zonetransfer.me.                                A      5.196.105.14
| zonetransfer.me.                                NS     nsztm1.digi.ninja.
| zonetransfer.me.                                NS     nsztm2.digi.ninja.
| _acme-challenge.zonetransfer.me.                TXT    "6Oa05hbUJ9xSsvYy7pApQvwCUSSGgxvrbdizjePEsZI"
| _sip._tcp.zonetransfer.me.                      SRV    0 0 5060 www.zonetransfer.me.
| 14.105.196.5.IN-ADDR.ARPA.zonetransfer.me.      PTR    www.zonetransfer.me.
| asfdbauthdns.zonetransfer.me.                   AFSDB  1 asfdbbox.zonetransfer.me.
| asfdbbox.zonetransfer.me.                       A      127.0.0.1
| asfdbvolume.zonetransfer.me.                    AFSDB  1 asfdbbox.zonetransfer.me.
| canberra-office.zonetransfer.me.                A      202.14.81.230
| cmdexec.zonetransfer.me.                        TXT    "; ls"
| contact.zonetransfer.me.                        TXT    "Remember to call or email Pippa on +44 123 4567890 or pippa@zonetransfer.me when making DNS changes"
| dc-office.zonetransfer.me.                      A      143.228.181.132
| deadbeef.zonetransfer.me.                       AAAA   dead:beaf::
| dr.zonetransfer.me.                             LOC    53.349044 N 1.642646 W 0m 1.0m 10000.0m 10.0m
| DZC.zonetransfer.me.                            TXT    "AbCdEfG"
| email.zonetransfer.me.                          NAPTR  1 1 "P" "E2U+email" "" email.zonetransfer.me.zonetransfer.me.
| email.zonetransfer.me.                          A      74.125.206.26
| Hello.zonetransfer.me.                          TXT    "Hi to Josh and all his class"
| home.zonetransfer.me.                           A      127.0.0.1
| Info.zonetransfer.me.                           TXT    "ZoneTransfer.me service provided by Robin Wood - robin@digi.ninja. See http://digi.ninja/projects/zonetransferme.php for more information."
| internal.zonetransfer.me.                       NS     intns1.zonetransfer.me.
| internal.zonetransfer.me.                       NS     intns2.zonetransfer.me.
| intns1.zonetransfer.me.                         A      81.4.108.41
| intns2.zonetransfer.me.                         A      167.88.42.94
| office.zonetransfer.me.                         A      4.23.39.254
| ipv6actnow.org.zonetransfer.me.                 AAAA   2001:67c:2e8:11::c100:1332
| owa.zonetransfer.me.                            A      207.46.197.32
| robinwood.zonetransfer.me.                      TXT    "Robin Wood"
| rp.zonetransfer.me.                             RP     robin.zonetransfer.me. robinwood.zonetransfer.me.
| sip.zonetransfer.me.                            NAPTR  2 3 "P" "E2U+sip" "!^.*$!sip:customer-service@zonetransfer.me!" .
| sqli.zonetransfer.me.                           TXT    "' or 1=1 --"
| sshock.zonetransfer.me.                         TXT    "() { :]}; echo ShellShocked"
| staging.zonetransfer.me.                        CNAME  www.sydneyoperahouse.com.
| alltcpportsopen.firewall.test.zonetransfer.me.  A      127.0.0.1
| testing.zonetransfer.me.                        CNAME  www.zonetransfer.me.
| vpn.zonetransfer.me.                            A      174.36.59.154
| www.zonetransfer.me.                            A      5.196.105.14
| xss.zonetransfer.me.                            TXT    "'><script>alert('Boo')</script>"
|_zonetransfer.me.                                SOA    nsztm1.digi.ninja. robin.digi.ninja.
WARNING: No targets were specified, so 0 hosts scanned.
Nmap done: 0 IP addresses (0 hosts up) scanned in 4.87 seconds
```

### 8.8.2 dns-brute

```sh
nmap -Pn --script dns-brute --script-args dns-brute.threads=5,dns-brute.hostlist=/usr/share/wordlists/SecLists/Discovery/DNS/fierce-hostlist.txt zonetransfer.me
`=>
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 22:17 EDT
Nmap scan report for zonetransfer.me (5.196.105.14)
Host is up (0.29s latency).
Not shown: 991 closed ports
PORT     STATE    SERVICE
21/tcp   open     ftp
80/tcp   open     http
135/tcp  filtered msrpc
139/tcp  filtered netbios-ssn
443/tcp  open     https
445/tcp  filtered microsoft-ds
593/tcp  filtered http-rpc-epmap
4444/tcp filtered krb524
8080/tcp open     http-proxy

Host script results:
| dns-brute: 
|   DNS Brute-force hostnames: 
|     owa.zonetransfer.me - 207.46.197.32
|     staging.zonetransfer.me - 18.65.214.101
|     staging.zonetransfer.me - 18.65.214.50
|     staging.zonetransfer.me - 18.65.214.6
|     staging.zonetransfer.me - 18.65.214.75
|     staging.zonetransfer.me - 2600:9000:221c:5600:3:59a3:1dc0:93a1
|     staging.zonetransfer.me - 2600:9000:221c:7600:3:59a3:1dc0:93a1
|     staging.zonetransfer.me - 2600:9000:2224:3400:3:59a3:1dc0:93a1
|     staging.zonetransfer.me - 2600:9000:2224:8400:3:59a3:1dc0:93a1
|     staging.zonetransfer.me - 2600:9000:2224:9000:3:59a3:1dc0:93a1
|     staging.zonetransfer.me - 2600:9000:2224:9200:3:59a3:1dc0:93a1
|     staging.zonetransfer.me - 2600:9000:2224:9800:3:59a3:1dc0:93a1
|     staging.zonetransfer.me - 2600:9000:2224:dc00:3:59a3:1dc0:93a1
|     testing.zonetransfer.me - 5.196.105.14
|     email.zonetransfer.me - 74.125.206.26
|_    vpn.zonetransfer.me - 174.36.59.154

Nmap done: 1 IP address (1 host up) scanned in 1649.03 seconds
```

## 8.9 Nmap - SMTP Enumeration

```sh
ls -al /usr/share/nmap/scripts/ | grep -e smtp
`=>
-rw-r--r-- 1 root root  4309 10月 12  2020 smtp-brute.nse
-rw-r--r-- 1 root root  4769 10月 12  2020 smtp-commands.nse
-rw-r--r-- 1 root root 12006 10月 12  2020 smtp-enum-users.nse
-rw-r--r-- 1 root root  5873 10月 12  2020 smtp-ntlm-info.nse
-rw-r--r-- 1 root root 10148 10月 12  2020 smtp-open-relay.nse
-rw-r--r-- 1 root root   716 10月 12  2020 smtp-strangeport.nse
-rw-r--r-- 1 root root 14781 10月 12  2020 smtp-vuln-cve2010-4344.nse
-rw-r--r-- 1 root root  7719 10月 12  2020 smtp-vuln-cve2011-1720.nse
-rw-r--r-- 1 root root  7603 10月 12  2020 smtp-vuln-cve2011-1764.nse
```

```sh
nmap -p25 --script smtp-commands 192.168.1.4    
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 22:24 EDT
Nmap scan report for 192.168.1.4
Host is up (0.00062s latency).

PORT   STATE SERVICE
25/tcp open  smtp
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 23.37 seconds
```

```sh
nmap -p25 --script smtp-enum-users --script-args smtp-enum-users.methods={VRFY} 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 22:27 EDT
Nmap scan report for 192.168.1.4
Host is up (0.00040s latency).

PORT   STATE SERVICE
25/tcp open  smtp
| smtp-enum-users: 
|_  Couldn't find any accounts
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 23.38 seconds
```

```sh
nmap -p25 --script smtp-open-relay 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 22:29 EDT
Nmap scan report for 192.168.1.4
Host is up (0.00058s latency).

PORT   STATE SERVICE
25/tcp open  smtp
|_smtp-open-relay: Server doesn't seem to be an open relay, all tests failed
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 41.39 seconds
```

```sh
nmap -p25 --script smtp-vuln-cve2010-4344 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 22:31 EDT
Nmap scan report for 192.168.1.4
Host is up (0.00072s latency).

PORT   STATE SERVICE
25/tcp open  smtp
| smtp-vuln-cve2010-4344: 
|_  The SMTP server is not Exim: NOT VULNERABLE
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 23.30 seconds
```

```sh
nmap -p25 --script smtp-vuln-cve2011-1720 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 22:32 EDT
Nmap scan report for 192.168.1.4
Host is up (0.00075s latency).

PORT   STATE SERVICE
25/tcp open  smtp
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 20.30 seconds
```

## 8.10 Nmap - HTTP Enumeration

### 8.10.1 Nmap - HTTP Enumeration - Detecting HTTP Methods

```sh
ls -al /usr/share/nmap/scripts/ | grep -e http
`=>
-rw-r--r-- 1 root root  2153 10月 12  2020 http-adobe-coldfusion-apsa1301.nse
-rw-r--r-- 1 root root  5149 10月 12  2020 http-affiliate-id.nse
-rw-r--r-- 1 root root  1950 10月 12  2020 http-apache-negotiation.nse
-rw-r--r-- 1 root root  4499 10月 12  2020 http-apache-server-status.nse
-rw-r--r-- 1 root root  1805 10月 12  2020 http-aspnet-debug.nse
-rw-r--r-- 1 root root  3959 10月 12  2020 http-auth-finder.nse
-rw-r--r-- 1 root root  3187 10月 12  2020 http-auth.nse
-rw-r--r-- 1 root root  2865 10月 12  2020 http-avaya-ipoffice-users.nse
-rw-r--r-- 1 root root  4372 10月 12  2020 http-awstatstotals-exec.nse
-rw-r--r-- 1 root root  6872 10月 12  2020 http-axis2-dir-traversal.nse
-rw-r--r-- 1 root root  5484 10月 12  2020 http-backup-finder.nse
-rw-r--r-- 1 root root  6387 10月 12  2020 http-barracuda-dir-traversal.nse
-rw-r--r-- 1 root root  2038 10月 12  2020 http-bigip-cookie.nse
-rw-r--r-- 1 root root  4920 10月 12  2020 http-brute.nse
-rw-r--r-- 1 root root  4436 10月 12  2020 http-cakephp-version.nse
-rw-r--r-- 1 root root  4927 10月 12  2020 http-chrono.nse
-rw-r--r-- 1 root root  1695 10月 12  2020 http-cisco-anyconnect.nse
-rw-r--r-- 1 root root  5520 10月 12  2020 http-coldfusion-subzero.nse
-rw-r--r-- 1 root root  4150 10月 12  2020 http-comments-displayer.nse
-rw-r--r-- 1 root root  7251 10月 12  2020 http-config-backup.nse
-rw-r--r-- 1 root root  5139 10月 12  2020 http-cookie-flags.nse
-rw-r--r-- 1 root root  2577 10月 12  2020 http-cors.nse
-rw-r--r-- 1 root root 13803 10月 12  2020 http-cross-domain-policy.nse
-rw-r--r-- 1 root root  5418 10月 12  2020 http-csrf.nse
-rw-r--r-- 1 root root  1718 10月 12  2020 http-date.nse
-rw-r--r-- 1 root root 17392 10月 12  2020 http-default-accounts.nse
-rw-r--r-- 1 root root  4288 10月 12  2020 http-devframework.nse
-rw-r--r-- 1 root root  2529 10月 12  2020 http-dlink-backdoor.nse
-rw-r--r-- 1 root root  4452 10月 12  2020 http-dombased-xss.nse
-rw-r--r-- 1 root root 13893 10月 12  2020 http-domino-enum-passwords.nse
-rw-r--r-- 1 root root  6931 10月 12  2020 http-drupal-enum.nse
-rw-r--r-- 1 root root  2256 10月 12  2020 http-drupal-enum-users.nse
-rw-r--r-- 1 root root 20667 10月 12  2020 http-enum.nse
-rw-r--r-- 1 root root  3347 10月 12  2020 http-errors.nse
-rw-r--r-- 1 root root 20413 10月 12  2020 http-exif-spider.nse
-rw-r--r-- 1 root root  5199 10月 12  2020 http-favicon.nse
-rw-r--r-- 1 root root  4451 10月 12  2020 http-feed.nse
-rw-r--r-- 1 root root  9076 10月 12  2020 http-fetch.nse
-rw-r--r-- 1 root root 11327 10月 12  2020 http-fileupload-exploiter.nse
-rw-r--r-- 1 root root 21103 10月 12  2020 http-form-brute.nse
-rw-r--r-- 1 root root  7934 10月 12  2020 http-form-fuzzer.nse
-rw-r--r-- 1 root root  2739 10月 12  2020 http-frontpage-login.nse
-rw-r--r-- 1 root root  2164 10月 12  2020 http-generator.nse
-rw-r--r-- 1 root root 12100 10月 12  2020 http-git.nse
-rw-r--r-- 1 root root  3195 10月 12  2020 http-gitweb-projects-enum.nse
-rw-r--r-- 1 root root  3381 10月 12  2020 http-google-malware.nse
-rw-r--r-- 1 root root 11692 10月 12  2020 http-grep.nse
-rw-r--r-- 1 root root  1797 10月 12  2020 http-headers.nse
-rw-r--r-- 1 root root  3383 10月 12  2020 http-hp-ilo-info.nse
-rw-r--r-- 1 root root  6973 10月 12  2020 http-huawei-hg5xx-vuln.nse
-rw-r--r-- 1 root root  2801 10月 12  2020 http-icloud-findmyiphone.nse
-rw-r--r-- 1 root root  4085 10月 12  2020 http-icloud-sendmsg.nse
-rw-r--r-- 1 root root  6073 10月 12  2020 http-iis-short-name-brute.nse
-rw-r--r-- 1 root root  7921 10月 12  2020 http-iis-webdav-vuln.nse
-rw-r--r-- 1 root root  2540 10月 12  2020 http-internal-ip-disclosure.nse
-rw-r--r-- 1 root root  5422 10月 12  2020 http-joomla-brute.nse
-rw-r--r-- 1 root root  5479 10月 12  2020 http-jsonp-detection.nse
-rw-r--r-- 1 root root  2649 10月 12  2020 http-litespeed-sourcecode-download.nse
-rw-r--r-- 1 root root  6116 10月 12  2020 http-ls.nse
-rw-r--r-- 1 root root  3269 10月 12  2020 http-majordomo2-dir-traversal.nse
-rw-r--r-- 1 root root  2838 10月 12  2020 http-malware-host.nse
-rw-r--r-- 1 root root  3704 10月 12  2020 http-mcmp.nse
-rw-r--r-- 1 root root  7320 10月 12  2020 http-methods.nse
-rw-r--r-- 1 root root  6895 10月 12  2020 http-method-tamper.nse
-rw-r--r-- 1 root root  2726 10月 12  2020 http-mobileversion-checker.nse
-rw-r--r-- 1 root root  4461 10月 12  2020 http-ntlm-info.nse
-rw-r--r-- 1 root root  8269 10月 12  2020 http-open-proxy.nse
-rw-r--r-- 1 root root  4756 10月 12  2020 http-open-redirect.nse
-rw-r--r-- 1 root root  7023 10月 12  2020 http-passwd.nse
-rw-r--r-- 1 root root  6225 10月 12  2020 http-phpmyadmin-dir-traversal.nse
-rw-r--r-- 1 root root  5822 10月 12  2020 http-phpself-xss.nse
-rw-r--r-- 1 root root  7070 10月 12  2020 http-php-version.nse
-rw-r--r-- 1 root root  3487 10月 12  2020 http-proxy-brute.nse
-rw-r--r-- 1 root root  1930 10月 12  2020 http-put.nse
-rw-r--r-- 1 root root  3591 10月 12  2020 http-qnap-nas-info.nse
-rw-r--r-- 1 root root  2175 10月 12  2020 http-referer-checker.nse
-rw-r--r-- 1 root root  9599 10月 12  2020 http-rfi-spider.nse
-rw-r--r-- 1 root root  2737 10月 12  2020 http-robots.txt.nse
-rw-r--r-- 1 root root  2305 10月 12  2020 http-robtex-reverse-ip.nse
-rw-r--r-- 1 root root  2776 10月 12  2020 http-robtex-shared-ns.nse
-rw-r--r-- 1 root root  5034 10月 12  2020 http-sap-netweaver-leak.nse
-rw-r--r-- 1 root root 15956 10月 12  2020 http-security-headers.nse
-rw-r--r-- 1 root root  3283 10月 12  2020 http-server-header.nse
-rw-r--r-- 1 root root  5489 10月 12  2020 http-shellshock.nse
-rw-r--r-- 1 root root  5344 10月 12  2020 http-sitemap-generator.nse
-rw-r--r-- 1 root root  5464 10月 12  2020 http-slowloris-check.nse
-rw-r--r-- 1 root root 11167 10月 12  2020 http-slowloris.nse
-rw-r--r-- 1 root root  9404 10月 12  2020 http-sql-injection.nse
-rw-r--r-- 1 root root  2528 10月 12  2020 https-redirect.nse
-rw-r--r-- 1 root root  8451 10月 12  2020 http-stored-xss.nse
-rw-r--r-- 1 root root  4018 10月 12  2020 http-svn-enum.nse
-rw-r--r-- 1 root root  4360 10月 12  2020 http-svn-info.nse
-rw-r--r-- 1 root root  2317 10月 12  2020 http-title.nse
-rw-r--r-- 1 root root  6026 10月 12  2020 http-tplink-dir-traversal.nse
-rw-r--r-- 1 root root  1947 10月 12  2020 http-trace.nse
-rw-r--r-- 1 root root  5294 10月 12  2020 http-traceroute.nse
-rw-r--r-- 1 root root  6437 10月 12  2020 http-trane-info.nse
-rw-r--r-- 1 root root  5549 10月 12  2020 http-unsafe-output-escaping.nse
-rw-r--r-- 1 root root  5403 10月 12  2020 http-useragent-tester.nse
-rw-r--r-- 1 root root  4550 10月 12  2020 http-userdir-enum.nse
-rw-r--r-- 1 root root  5820 10月 12  2020 http-vhosts.nse
-rw-r--r-- 1 root root 10770 10月 12  2020 http-virustotal.nse
-rw-r--r-- 1 root root  2078 10月 12  2020 http-vlcstreamer-ls.nse
-rw-r--r-- 1 root root  4111 10月 12  2020 http-vmware-path-vuln.nse
-rw-r--r-- 1 root root  3273 10月 12  2020 http-vuln-cve2006-3392.nse
-rw-r--r-- 1 root root  6610 10月 12  2020 http-vuln-cve2009-3960.nse
-rw-r--r-- 1 root root  2957 10月 12  2020 http-vuln-cve2010-0738.nse
-rw-r--r-- 1 root root  5607 10月 12  2020 http-vuln-cve2010-2861.nse
-rw-r--r-- 1 root root  4527 10月 12  2020 http-vuln-cve2011-3192.nse
-rw-r--r-- 1 root root  5851 10月 12  2020 http-vuln-cve2011-3368.nse
-rw-r--r-- 1 root root  4403 10月 12  2020 http-vuln-cve2012-1823.nse
-rw-r--r-- 1 root root  4831 10月 12  2020 http-vuln-cve2013-0156.nse
-rw-r--r-- 1 root root  2853 10月 12  2020 http-vuln-cve2013-6786.nse
-rw-r--r-- 1 root root  5009 10月 12  2020 http-vuln-cve2013-7091.nse
-rw-r--r-- 1 root root  2945 10月 12  2020 http-vuln-cve2014-2126.nse
-rw-r--r-- 1 root root  3334 10月 12  2020 http-vuln-cve2014-2127.nse
-rw-r--r-- 1 root root  3193 10月 12  2020 http-vuln-cve2014-2128.nse
-rw-r--r-- 1 root root  2979 10月 12  2020 http-vuln-cve2014-2129.nse
-rw-r--r-- 1 root root 14018 10月 12  2020 http-vuln-cve2014-3704.nse
-rw-r--r-- 1 root root  4523 10月 12  2020 http-vuln-cve2014-8877.nse
-rw-r--r-- 1 root root  7774 10月 12  2020 http-vuln-cve2015-1427.nse
-rw-r--r-- 1 root root  3443 10月 12  2020 http-vuln-cve2015-1635.nse
-rw-r--r-- 1 root root  4372 10月 12  2020 http-vuln-cve2017-1001000.nse
-rw-r--r-- 1 root root  2594 10月 12  2020 http-vuln-cve2017-5638.nse
-rw-r--r-- 1 root root  5480 10月 12  2020 http-vuln-cve2017-5689.nse
-rw-r--r-- 1 root root  5187 10月 12  2020 http-vuln-cve2017-8917.nse
-rw-r--r-- 1 root root  2699 10月 12  2020 http-vuln-misfortune-cookie.nse
-rw-r--r-- 1 root root  4225 10月 12  2020 http-vuln-wnr1000-creds.nse
-rw-r--r-- 1 root root  5422 10月 12  2020 http-waf-detect.nse
-rw-r--r-- 1 root root 19339 10月 12  2020 http-waf-fingerprint.nse
-rw-r--r-- 1 root root  5806 10月 12  2020 http-webdav-scan.nse
-rw-r--r-- 1 root root  5061 10月 12  2020 http-wordpress-brute.nse
-rw-r--r-- 1 root root 10866 10月 12  2020 http-wordpress-enum.nse
-rw-r--r-- 1 root root  4641 10月 12  2020 http-wordpress-users.nse
-rw-r--r-- 1 root root  2653 10月 12  2020 http-xssed.nse
-rw-r--r-- 1 root root  2437 10月 12  2020 ip-https-discover.nse
-rw-r--r-- 1 root root  4900 10月 12  2020 membase-http-info.nse
-rw-r--r-- 1 root root  5564 10月 12  2020 riak-http-info.nse
(base) lawjune@lawjune-ThinkPad-T530:~$ ls -al /usr/share/nmap/scripts/ | grep -e http-enum
-rw-r--r-- 1 root root 20667 10月 12  2020 http-enum.nse
```

***Focus on the HTTP methods first!***

```sh
nmap -Pn -sV -p 80 -T4 --script http-methods --script-args http-methods.test=all nmap.scanme.org
`=>
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-28 10:40 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up (0.20s latency).
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))
| http-methods: 
|_  Supported Methods: POST OPTIONS GET HEAD
|_http-server-header: Apache/2.4.7 (Ubuntu)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.71 seconds
```

### 8.10.2 Nmap - HTTP Enumeration - Finding Hidden Files and Directories


```sh
nmap -F -sV -T5 192.168.1.4  
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 22:53 EDT
Nmap scan report for 192.168.1.4
Host is up (0.00016s latency).
Not shown: 82 closed ports
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
53/tcp   open  domain      ISC BIND 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
111/tcp  open  rpcbind     2 (RPC #100000)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
513/tcp  open  login?
514/tcp  open  shell       Netkit rshd
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
6000/tcp open  X11         (access denied)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)
Service Info: Host:  metasploitable.localdomain; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 49.76 seconds
```

**80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu)**

```sh
nmap -sV -p 80 --script http-enum 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 22:55 EDT
Nmap scan report for 192.168.1.4
Host is up (0.00056s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.2.8 ((Ubuntu) DAV/2)
| http-enum: 
|   /tikiwiki/: Tikiwiki
|   /test/: Test page
|   /phpinfo.php: Possible information file
|   /phpMyAdmin/: phpMyAdmin
|   /doc/: Potentially interesting directory w/ listing on 'apache/2.2.8 (ubuntu) dav/2'
|   /icons/: Potentially interesting folder w/ directory listing
|_  /index/: Potentially interesting folder
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 31.50 seconds
```

### 8.10.3 Nmap - HTTP Enumeration - WAF(Web Application Firewall) Detection and Fingerprinting

```sh
ls -al /usr/share/nmap/scripts/ | grep -e http-waf
`=>
-rw-r--r-- 1 root root  5422 10月 12  2020 http-waf-detect.nse
-rw-r--r-- 1 root root 19339 10月 12  2020 http-waf-fingerprint.nse
```

**Nothing Found**
```sh
nmap -Pn -p 80 --script http-waf-detect nmap.scanme.org
`=>
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-28 13:44 CST
Nmap scan report for nmap.scanme.org (45.33.32.156)
Host is up.
Other addresses for nmap.scanme.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
rDNS record for 45.33.32.156: scanme.nmap.org

PORT   STATE    SERVICE
80/tcp filtered http

Nmap done: 1 IP address (1 host up) scanned in 12.92 seconds
```

```sh
nmap -Pn -p 443 --script http-waf-detect hackersploit.org
`=>
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-28 13:50 CST
Nmap scan report for hackersploit.org (172.67.202.99)
Host is up (0.32s latency).
Other addresses for hackersploit.org (not scanned): 2606:4700:3031::6815:2cb4 2606:4700:3036::ac43:ca63 104.21.44.180

PORT    STATE SERVICE
443/tcp open  https
| http-waf-detect: IDS/IPS/WAF detected:
|_hackersploit.org:443/?p4yl04d3=<script>alert(document.cookie)</script>

Nmap done: 1 IP address (1 host up) scanned in 4.51 seconds
```

## 8.11 Nmap - SMB Enumeration

*The Server Message Block protocol (SMB protocol) is a client-server communication protocol used for sharing access to files, printers, serial ports and other resources on a network. ... The protocol has since spawned multiple variants, also known as dialects, to meet evolving network requirements over the years.*

```sh
ls -al /usr/share/nmap/scripts/ | grep -e smb
`=>
-rw-r--r-- 1 root root  3355 10月 12  2020 smb2-capabilities.nse
-rw-r--r-- 1 root root  3075 10月 12  2020 smb2-security-mode.nse
-rw-r--r-- 1 root root  1447 10月 12  2020 smb2-time.nse
-rw-r--r-- 1 root root  5238 10月 12  2020 smb2-vuln-uptime.nse
-rw-r--r-- 1 root root 45138 10月 12  2020 smb-brute.nse
-rw-r--r-- 1 root root  5289 10月 12  2020 smb-double-pulsar-backdoor.nse
......(a lot...)
```

```sh
map -p 445 --script smb-os-discovery 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-28 02:05 EDT
Nmap scan report for localhost (192.168.1.4)
Host is up (0.00051s latency).

PORT    STATE SERVICE
445/tcp open  microsoft-ds
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Host script results:
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2021-09-28T02:05:13-04:00

Nmap done: 1 IP address (1 host up) scanned in 3.95 seconds
```

```sh
nmap -p 445 --script smb-enum-shares 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-28 02:07 EDT
Nmap scan report for localhost (192.168.1.4)
Host is up (0.00076s latency).

PORT    STATE SERVICE
445/tcp open  microsoft-ds
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Host script results:
| smb-enum-shares: 
|   account_used: <blank>
|   \\192.168.1.4\ADMIN$: 
|     Type: STYPE_IPC
|     Comment: IPC Service (metasploitable server (Samba 3.0.20-Debian))
|     Users: 1
|     Max Users: <unlimited>
|     Path: C:\tmp
|     Anonymous access: <none>
|   \\192.168.1.4\IPC$: 
|     Type: STYPE_IPC
|     Comment: IPC Service (metasploitable server (Samba 3.0.20-Debian))
|     Users: 1
|     Max Users: <unlimited>
|     Path: C:\tmp
|     Anonymous access: READ/WRITE
|   \\192.168.1.4\opt: 
|     Type: STYPE_DISKTREE
|     Comment: 
|     Users: 1
|     Max Users: <unlimited>
|     Path: C:\tmp
|     Anonymous access: <none>
|   \\192.168.1.4\print$: 
|     Type: STYPE_DISKTREE
|     Comment: Printer Drivers
|     Users: 1
|     Max Users: <unlimited>
|     Path: C:\var\lib\samba\printers
|     Anonymous access: <none>
|   \\192.168.1.4\tmp: 
|     Type: STYPE_DISKTREE
|     Comment: oh noes!
|     Users: 1
|     Max Users: <unlimited>
|     Path: C:\tmp
|_    Anonymous access: READ/WRITE

Nmap done: 1 IP address (1 host up) scanned in 0.70 seconds
```

```sh
nmap -p 445 --script smb-enum-users 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-28 02:09 EDT
Nmap scan report for localhost (192.168.1.4)
Host is up (0.00040s latency).

PORT    STATE SERVICE
445/tcp open  microsoft-ds
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Host script results:
| smb-enum-users: 
|   METASPLOITABLE\backup (RID: 1068)
|     Full name:   backup
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\bin (RID: 1004)
|     Full name:   bin
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\bind (RID: 1210)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\daemon (RID: 1002)
|     Full name:   daemon
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\dhcp (RID: 1202)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\distccd (RID: 1222)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\ftp (RID: 1214)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\games (RID: 1010)
|     Full name:   games
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\gnats (RID: 1082)
|     Full name:   Gnats Bug-Reporting System (admin)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\irc (RID: 1078)
|     Full name:   ircd
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\klog (RID: 1206)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\libuuid (RID: 1200)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\list (RID: 1076)
|     Full name:   Mailing List Manager
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\lp (RID: 1014)
|     Full name:   lp
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\mail (RID: 1016)
|     Full name:   mail
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\man (RID: 1012)
|     Full name:   man
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\msfadmin (RID: 3000)
|     Full name:   msfadmin,,,
|     Flags:       Normal user account
|   METASPLOITABLE\mysql (RID: 1218)
|     Full name:   MySQL Server,,,
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\news (RID: 1018)
|     Full name:   news
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\nobody (RID: 501)
|     Full name:   nobody
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\postfix (RID: 1212)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\postgres (RID: 1216)
|     Full name:   PostgreSQL administrator,,,
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\proftpd (RID: 1226)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\proxy (RID: 1026)
|     Full name:   proxy
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\root (RID: 1000)
|     Full name:   root
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\service (RID: 3004)
|     Full name:   ,,,
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\sshd (RID: 1208)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\sync (RID: 1008)
|     Full name:   sync
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\sys (RID: 1006)
|     Full name:   sys
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\syslog (RID: 1204)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\telnetd (RID: 1224)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\tomcat55 (RID: 1220)
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\user (RID: 3002)
|     Full name:   just a user,111,,
|     Flags:       Normal user account
|   METASPLOITABLE\uucp (RID: 1020)
|     Full name:   uucp
|     Flags:       Account disabled, Normal user account
|   METASPLOITABLE\www-data (RID: 1066)
|     Full name:   www-data
|_    Flags:       Account disabled, Normal user account

Nmap done: 1 IP address (1 host up) scanned in 0.40 seconds
```

```sh
nmap -p 445 --script smb-protocols 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-28 02:11 EDT
Nmap scan report for localhost (192.168.1.4)
Host is up (0.00072s latency).

PORT    STATE SERVICE
445/tcp open  microsoft-ds
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Host script results:
| smb-protocols: 
|   dialects: 
|_    NT LM 0.12 (SMBv1) [dangerous, but default]

Nmap done: 1 IP address (1 host up) scanned in 0.39 seconds
```

***Try `nmap -p 445 --script smb-vuln-ms17-010` in Windows target***

## 8.12 Nmap - MySQL Enumeration

```sh
ls -al /usr/share/nmap/scripts/ | grep -e mysql
`=>
-rw-r--r-- 1 root root  6632 10月 12  2020 mysql-audit.nse
-rw-r--r-- 1 root root  2977 10月 12  2020 mysql-brute.nse
-rw-r--r-- 1 root root  2945 10月 12  2020 mysql-databases.nse
-rw-r--r-- 1 root root  3263 10月 12  2020 mysql-dump-hashes.nse
-rw-r--r-- 1 root root  2020 10月 12  2020 mysql-empty-password.nse
-rw-r--r-- 1 root root  3413 10月 12  2020 mysql-enum.nse
-rw-r--r-- 1 root root  3455 10月 12  2020 mysql-info.nse
-rw-r--r-- 1 root root  3714 10月 12  2020 mysql-query.nse
-rw-r--r-- 1 root root  2811 10月 12  2020 mysql-users.nse
-rw-r--r-- 1 root root  3265 10月 12  2020 mysql-variables.nse
-rw-r--r-- 1 root root  6977 10月 12  2020 mysql-vuln-cve2012-2122.nse
```

```sh
nmap -p 3306 --script mysql-info 192.168.1.4 
`=>     
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-28 02:19 EDT
Nmap scan report for localhost (192.168.1.4)
Host is up (0.00040s latency).

PORT     STATE SERVICE
3306/tcp open  mysql
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 7
|   Capabilities flags: 43564
|   Some Capabilities: SupportsTransactions, Support41Auth, LongColumnFlag, ConnectWithDatabase, Speaks41ProtocolNew, SwitchToSSLAfterHandshake, SupportsCompression
|   Status: Autocommit
|_  Salt: J<,d6~=Rcz^F&*=4-%o"
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.31 seconds
```

```sh
nmap -p 3306 --script mysql-empty-password 192.168.1.4 
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-28 02:21 EDT
Nmap scan report for localhost (192.168.1.4)
Host is up (0.00043s latency).

PORT     STATE SERVICE
3306/tcp open  mysql
| mysql-empty-password: 
|_  root account has empty password
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.33 seconds
```

## 8.13 Vulnerability Scanning with Nmap

```sh
mysql -u root -h 192.168.1.4 -p
`=>(We can remove the "-p"), no need to input password
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MySQL connection id is 27
Server version: 5.0.51a-3ubuntu5 (Ubuntu)

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MySQL [(none)]>
```

```sh
nmap -p 3306 --script mysql-brute --script-args mysql-brute.threads=100 192.168.1.4
`=>
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-28 02:26 EDT
Nmap scan report for localhost (192.168.1.4)
Host is up (0.00037s latency).

PORT     STATE SERVICE
3306/tcp open  mysql
| mysql-brute: 
|   Accounts: 
|     root:<empty> - Valid credentials
|     guest:<empty> - Valid credentials
|_  Statistics: Performed 40013 guesses in 29 seconds, average tps: 1350.8
MAC Address: 08:00:27:03:A4:43 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 30.18 seconds
```

```sh
mysql -u guest -h 192.168.1.4
`=>
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MySQL connection id is 40043
Server version: 5.0.51a-3ubuntu5 (Ubuntu)

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MySQL [(none)]> 
```

## 8.14 Vulnerability Scanning with Nmap

https://github.com/vulnersCom/nmap-vulners

**The default script**

```sh
ls -al /usr/share/nmap/scripts/ | grep -e vulners
`=>
-rw-r--r-- 1 root root  7058 10月 12  2020 vulners.nse
```

```sh
nmap -sV -p21-8080 --script vulners 192.168.1.4
```
**=>There will be bunch of results!**

## 8.15 Greenbone Community Edition - Virtual Appliance Setup & Configuration

https://www.openvas.org/

**OpenVAS – Open Vulnerability Assessment Scanner**


# Section 9 - Exploitation (Windows & Linux Exploitation, Metasploit & Custom Exploits)


## 9.1 Dumping S3 Buckets | Exploiting S3 Bucket Misconfigurations

http://flaws.cloud/

```sh
host flaws.cloud
`=>
flaws.cloud has address 52.218.236.66
```

```sh
dnsrecon -d flaws.cloud
`=>
[*] Performing General Enumeration of Domain: flaws.cloud
[-] DNSSEC is not configured for flaws.cloud
[*]      SOA ns-1890.awsdns-44.co.uk 205.251.199.98
[*]      NS ns-448.awsdns-56.com 205.251.193.192
[-]      Recursion enabled on NS Server 205.251.193.192
[*]      NS ns-1061.awsdns-04.org 2600:9000:5304:2500::1
[-]      Recursion enabled on NS Server 2600:9000:5304:2500::1
[*]      NS ns-966.awsdns-56.net 205.251.195.198
[-]      Recursion enabled on NS Server 205.251.195.198
[*]      NS ns-966.awsdns-56.net 2600:9000:5303:c600::1
[*]      NS ns-1890.awsdns-44.co.uk 205.251.199.98
[-]      Recursion enabled on NS Server 205.251.199.98
[*]      NS ns-1890.awsdns-44.co.uk 2600:9000:5307:6200::1
[-]      Recursion enabled on NS Server 2600:9000:5307:6200::1
[-] Could not Resolve MX Records for flaws.cloud
[*]      A flaws.cloud 52.92.145.107
[*] Enumerating SRV Records
[+] 0 Records Found
```

***---------***


## 9.2 Anonymize Your Traffic with Proxychains & Tor

*A proxy or proxy server is a dedicated computer or software system running on a computer which acts as an intermediary between an end device.*


**PROXYCHAINS FEATURES
* Support SOCKS5, SOCKS4, and HTTP CONNECT proxy servers.
* Proxychains can be mixed up with a different proxy types in a list.
* Proxychains also supports any kinds of chaining option methods, like: random, which takes a random proxy in the list stored in a configuration file, or chaining proxies in the exact order list, different proxies are separated by a new line in a file. There is also a dynamic option, that lets Proxychains go through the live only proxies, it will exclude the dead or unreachable proxies, the dynamic option often called smart option.
* Proxychains can be used with servers, like squid, sendmail, etc.
* Proxychains is capable to do DNS resolving through proxy.
* Proxychains can handle any TCP client application, ie., nmap, telnet.**

```sh
sudo apt install proxychains tor -y
```

```sh
sudo vim /etc/proxychains.conf
```

```sh
sudo systemctl enable tor.service
```

```sh
sudo systemctl status tor.service
`=>
● tor.service - Anonymizing overlay network for TCP (multi-instance-master)
     Loaded: loaded (/lib/systemd/system/tor.service; enabled; vendor preset: disabled)
     Active: inactive (dead)
```

```sh
sudo systemctl start tor.service
```

```sh
sudo systemctl status tor.service
`=>
Failed to get journal cutoff time: Bad message
● tor.service - Anonymizing overlay network for TCP (multi-instance-master)
     Loaded: loaded (/lib/systemd/system/tor.service; enabled; vendor preset: disabled)
     Active: active (exited) since Tue 2021-09-28 20:57:22 EDT; 2s ago
    Process: 1787 ExecStart=/bin/true (code=exited, status=0/SUCCESS)
   Main PID: 1787 (code=exited, status=0/SUCCESS)
        CPU: 1ms

Sep 28 20:57:22 kali systemd[1]: Starting Anonymizing overlay network for TCP (multi-instance-ma>
Sep 28 20:57:22 kali systemd[1]: Finished Anonymizing overlay network for TCP (multi-instance-ma>
lines 1-10/10 (END)
```

```sh
proxychains firefox dnsleaktest.com
```

```sh
proxychains nmap 192.168.1.1/24
```


## 9.3 Windows Privilege Escalation Tutorial for Beginners

## 9.4 DEF CON DC9111 - Docker For Pentesting & Bug Bounty Hunting

### 9.4.1 What is Docker?

* **Docker allows you to build and deploy applications and services in the form of containers.**

* **It is a platform as a sevice (PaaS) offering that utilizes the host OS Kernel as opposed to hypervisors llike VMware.**

* **The containers contain the dependencies and libraries that that application or service needs to run, therefore eliminating the need for installing dependencies and managing hte OS.**

* **Docker containers are much more efficient that VM's as they utilize the host kernel.**

**Docker vs Traditional Hypervisors
* [Infrastructure] -> [Host Operating System] -> [Docker] -> (Containerized Applications)[AppA, AppB, ...]
* [Infrastructure] -> [Hypervisor] -> ([Guest Operating System] -> [App A], [Guest Operating System] -> [App B] ...)**

### 9.4.2 Advantages of Using Docker for Pentesting & Bug Bounty Hunting

* **Provides a multi-platform solution/base for running container.**

* **Containerzied offensive distributions like Kali and Parrot with full repo support.**

* **Containerzied vulnerable web apps like OWASP Juice Shop, DVWA that can be used for training and learning.**

* **Pentesting & bug bounty toolkits.**

* **Resource efficient.**

* **Tools and images can easily be updated.**

### 9.4.3 Install Docker and Pull Ubuntu

```sh
sudo apt install docker.io
sudo systemctl enable docker
sudo systemctl start docker
sudo systemctl status docker
```

https://hub.docker.com/_/ubuntu


```sh
sudo docker pull ubuntu
```

```sh
sudo docker images
`=>
REPOSITORY   TAG       IMAGE ID       CREATED       SIZE
ubuntu       latest    fb52e22af1b0   4 weeks ago   72.8MB
```

```sh
sudo docker run -it --name test fb52e22af1b0 /bin/bash
`=>
root@b56708a171c4:/#
```

```sh
root@b56708a171c4:~# vim text.txt
root@b56708a171c4:~# exit
```

```sh
sudo docker ps -a
`=>
CONTAINER ID   IMAGE          COMMAND       CREATED         STATUS                      PORTS     NAMES
b56708a171c4   fb52e22af1b0   "/bin/bash"   2 minutes ago   Exited (0) 12 seconds ago             test
```

```sh
sudo docker container start test
sudo docker ps -a
`=>
CONTAINER ID   IMAGE          COMMAND       CREATED         STATUS         PORTS     NAMES
b56708a171c4   fb52e22af1b0   "/bin/bash"   4 minutes ago   Up 5 seconds             test
```

=> 20 seconds later
```sh
sudo docker ps -a
`=>
CONTAINER ID   IMAGE          COMMAND       CREATED         STATUS          PORTS     NAMES
b56708a171c4   fb52e22af1b0   "/bin/bash"   4 minutes ago   Up 25 seconds             test
```

=> Login
```sh
sudo docker container attach test
```

```sh
sudo docker rm test
```

### 9.4.4 Pull Kali & Parrot 

```sh
sudo docker pull kalilinux/kali-rolling
```

```sh
sudo docker images
`=>
REPOSITORY               TAG       IMAGE ID       CREATED        SIZE
kalilinux/kali-rolling   latest    b0e0b9dec2a3   24 hours ago   126MB
ubuntu                   latest    fb52e22af1b0   4 weeks ago    72.8MB
```

```sh
sudo docker run -it --rm --name test b0e0b9dec2a3 /bin/bash
`=>
┌──(root💀957c61c819b8)-[/]
└─# cat /etc/issue
Kali GNU/Linux Rolling \n \l
```

```sh
┌──(root💀957c61c819b8)-[~]
└─# apt update
```

```sh
┌──(root💀957c61c819b8)-[~]
└─# apt install nmap fierce dnsenum gobuster 
```

```sh
sudo docker ps -a
`=> `rm` will delete the instance while exiting 
```

***Recommend to use Parrot in Docker***

```sh
sudo docker pull parrotsec/core
```

### 9.4.5 Bug Bounty Toolkit

https://github.com/AlexisAhmed/BugBountyToolkit

```sh
sudo docker pull hackersploit/bugbountytoolkit
```

### 9.4.6 OWASP Juice Shop 

```sh
sudo docker pull bkimminich/juice-shop
```

```sh
sudo docker run --rm -p 3000 ${IMAGE_ID}
```

# Section 10 - AV(AntiVirus) Evasion

# Section 11 - Post Expoitation

# Section 12 - Password Cracking

# Section 13 - Web Application Penetration Testing
